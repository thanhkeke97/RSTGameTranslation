<Window
    x:Class="RSTGameTranslation.SettingsWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:RSTGameTranslation"
    mc:Ignorable="d"
    Title="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Settings_Title]}"
    Height="550"
    Width="600"
    WindowStyle="SingleBorderWindow"
    ResizeMode="CanResizeWithGrip"
    Icon="/media/AppIcon.ico">
    <Window.Resources>
        <Style TargetType="ComboBox" BasedOn="{StaticResource ThemedComboBox}"/>
        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource ThemedComboBoxItem}"/>
        <Style TargetType="Button">
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="Background" Value="{DynamicResource Surface2Brush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="6,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Foreground" Value="{DynamicResource MutedBrush}"/>
                    <Setter Property="Background" Value="{DynamicResource Surface3Brush}"/>
                    <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                    <Setter Property="Opacity" Value="0.9"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Grid>
        <TabControl Margin="5">
            <!-- Language Settings Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_Language]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Language Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_LanguageSettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Source Language -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SourceLanguage]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="sourceLanguageComboBox" Grid.Row="0" Grid.Column="1" 
                                         Margin="0,5" SelectedIndex="0" SelectionChanged="SourceLanguageComboBox_SelectionChanged">
                                    <ComboBoxItem Content="ja"/>
                                    <ComboBoxItem Content="en"/>
                                    <ComboBoxItem Content="ch_sim"/>
                                    <ComboBoxItem Content="ch_tra"/>
                                    <ComboBoxItem Content="ko"/>
                                    <ComboBoxItem Content="vi"/>
                                    <ComboBoxItem Content="fr"/>
                                    <ComboBoxItem Content="ru"/>
                                    <ComboBoxItem Content="de"/>
                                    <ComboBoxItem Content="es"/>
                                    <ComboBoxItem Content="it"/>
                                    <ComboBoxItem Content="hi"/>
                                    <ComboBoxItem Content="pt"/>
                                    <ComboBoxItem Content="ar"/>
                                    <ComboBoxItem Content="nl"/>
                                    <ComboBoxItem Content="pl"/>
                                    <ComboBoxItem Content="ro"/>
                                    <ComboBoxItem Content="fa"/>
                                    <ComboBoxItem Content="cs"/>
                                    <ComboBoxItem Content="id"/>
                                    <ComboBoxItem Content="th"/>
                                    <ComboBoxItem Content="hr"/>
                                    <ComboBoxItem Content="tr"/>
                                    <ComboBoxItem Content="si"/>
                                    <ComboBoxItem Content="da"/>
                                    <ComboBoxItem Content="uk"/>
                                    <ComboBoxItem Content="fi"/>
                                </ComboBox>
                                
                                <!-- Swap Languages Button placed between source and target in its own column -->
                                <Button x:Name="swapLanguagesButton" Grid.Row="0" Grid.Column="2" Grid.RowSpan="2"
                                        VerticalAlignment="Center" Width="30" Height="30" Margin="10,0"
                                        Click="SwapLanguagesButton_Click" ToolTip="Swap source and target languages">
                                    <TextBlock Text="â‡„" FontSize="16" FontWeight="Bold" />
                                </Button>
                                
                                <!-- Target Language -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_TargetLanguage]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="targetLanguageComboBox" Grid.Row="1" Grid.Column="1" 
                                         Margin="0,5" SelectedIndex="1" SelectionChanged="TargetLanguageComboBox_SelectionChanged">
                                    <ComboBoxItem Content="ja"/>
                                    <ComboBoxItem Content="en"/>
                                    <ComboBoxItem Content="ch_sim"/>
                                    <ComboBoxItem Content="ch_tra"/>
                                    <ComboBoxItem Content="ko"/>
                                    <ComboBoxItem Content="vi"/>
                                    <ComboBoxItem Content="fr"/>
                                    <ComboBoxItem Content="ru"/>
                                    <ComboBoxItem Content="de"/>
                                    <ComboBoxItem Content="es"/>
                                    <ComboBoxItem Content="it"/>
                                    <ComboBoxItem Content="hi"/>
                                    <ComboBoxItem Content="pt"/>
                                    <ComboBoxItem Content="ar"/>
                                    <ComboBoxItem Content="nl"/>
                                    <ComboBoxItem Content="pl"/>
                                    <ComboBoxItem Content="ro"/>
                                    <ComboBoxItem Content="fa"/>
                                    <ComboBoxItem Content="cs"/>
                                    <ComboBoxItem Content="id"/>
                                    <ComboBoxItem Content="th"/>
                                    <ComboBoxItem Content="hr"/>
                                    <ComboBoxItem Content="tr"/>
                                    <ComboBoxItem Content="si"/>
                                    <ComboBoxItem Content="da"/>
                                    <ComboBoxItem Content="uk"/>
                                    <ComboBoxItem Content="fi"/>
                                </ComboBox>

                                <!-- WinOCR Language Pack Check-->
                                <TextBlock x:Name="checkLanguagePack" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_CheckLanguagePack]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"  ToolTip="Check if the language package is installed."/>
                                <Button x:Name="checkLanguagePackButton" Grid.Row="2" Grid.Column="1"
                                        Width="60" Height="20" Margin="10,0"
                                        Click="CheckLanguagePackButton_Click">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_Check]}"/>
                                </Button>
                            </Grid>
                        </GroupBox>
                        <!-- Language Code Explanation -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_LanguageMapping]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" 
                                    Margin="0,15,0,0" TextWrapping="Wrap" FontSize="12">
                                <Run>ja = Japanese</Run>
                                <LineBreak/>
                                <Run>en = English</Run>
                                <LineBreak/>
                                <Run>ch_sim = Chinese (Simplified)</Run>
                                <LineBreak/>
                                <Run>ko = Korean</Run>
                                <LineBreak/>
                                <Run>vi = Vietnamese</Run>
                                <LineBreak/>
                                <Run>fr = French</Run>
                                <LineBreak/>
                                <Run>ru = Russian</Run>
                                <LineBreak/>
                                <Run>de = German</Run>
                                <LineBreak/>
                                <Run>es = Spanish</Run>
                                <LineBreak/>
                                <Run>it = Italian</Run>
                                <LineBreak/>
                                <Run>hi = Hindi</Run>
                                <LineBreak/>
                                <Run>tr = Turkish</Run>
                                <LineBreak/>
                                <Run>da = Danish</Run>
                                <LineBreak/>
                                <Run>uk = Ukraina</Run>
                            </TextBlock>
                            <TextBlock Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="3" 
                                Margin="0,15,0,0" TextWrapping="Wrap" FontSize="12">
                                <Run>pt = Portuguese</Run>
                                <LineBreak/>
                                <Run>ar = Arabic</Run>
                                <LineBreak/>
                                <Run>nl = Dutch</Run>
                                <LineBreak/>
                                <Run>pl = Polish</Run>
                                <LineBreak/>
                                <Run>ro = Romanian</Run>
                                <LineBreak/>
                                <Run>fa = Farsi</Run>
                                <LineBreak/>
                                <Run>cs = Czech</Run>
                                <LineBreak/>
                                <Run>id = Indonesian</Run>
                                <LineBreak/>
                                <Run>th = ThaiLand</Run>
                                <LineBreak/>
                                <Run>ch_tra = Traditional Chinese</Run>
                                <LineBreak/>
                                <Run>hr = Croatian</Run>
                                <LineBreak/>
                                <Run>si = Sinhala</Run>
                                <LineBreak/>
                                <Run>fi = Finnish</Run>
                            </TextBlock>
                            </Grid>
                        </GroupBox>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- OCR/Screen Selection Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_OCRScreen]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- OCR/Screen Selection -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_OCRScreenSelection]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- OCR Method -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_OCRMethod]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="ocrMethodComboBox" Grid.Row="0" Grid.Column="1" 
                                         Margin="0,5" SelectedIndex="1" SelectionChanged="OcrMethodComboBox_SelectionChanged">
                                    <ComboBoxItem Content="EasyOCR"/>
                                    <ComboBoxItem Content="Windows OCR"/>
                                    <ComboBoxItem Content="PaddleOCR"/>
                                    <ComboBoxItem Content="RapidOCR"/>
                                    <ComboBoxItem Content="OneOCR"/>
                                </ComboBox>
                                <!-- Remove OCR and Setup Buttons -->
                                <StackPanel x:Name="ocrButtonsPanel" Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="removeOcrButton"
                                        Margin="0,5" Width="100" HorizontalAlignment="Left" Click="RemoveOcrButton_Click"
                                        Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_RemoveOCR]}"/>

                                    <Button x:Name="btnSetupOcrServer" Margin="8,5,0,5" Width="120" HorizontalAlignment="Left"
                                            Click="Settings_BtnSetupOcrServer_Click"
                                            Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SetupOCR]}"/>
                                </StackPanel>
                                
                                <!-- WINDOWS OCR integration -->
                                <!-- <TextBlock Text="Windows OCR integration:" Grid.Row="1" Grid.Column="0" 
                                          ToolTip="This feature will use windowsOCR as a filter for the results before sending them to other OCRs. This feature will improve performance but will reduce accuracy in some cases"
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="windowsOCRIntegrationCheckBox" Grid.Row="1" Grid.Column="1" 
                                         Margin="0,5"
                                         ToolTip="This feature will use windowsOCR as a filter for the results before sending them to other OCRs. This feature will improve performance but will reduce accuracy in some cases"
                                         Checked="WindowsOCRIntegrationCheckBox_CheckedChanged" 
                                         Unchecked="WindowsOCRIntegrationCheckBox_CheckedChanged"/> -->

                                <!-- HDR support -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_HDRSupport]}" Grid.Row="9" Grid.Column="0" 
                                          ToolTip="This feature will use HDR support for the results before sending them to other OCRs. This feature will improve performance but will reduce accuracy in some cases"
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="hdrSupportCheckBox" Grid.Row="9" Grid.Column="1" 
                                         Margin="0,5"
                                         ToolTip="This feature will use HDR support for the results before sending them to other OCRs. This feature will improve performance but will reduce accuracy in some cases"
                                         Checked="HDRSupportCheckBox_CheckedChanged" 
                                         Unchecked="HDRSupportCheckBox_CheckedChanged"/>
                                
                                <!-- Select Screen -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectScreen]}" Grid.Row="8" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="screenComboBox" Grid.Row="8" Grid.Column="1" 
                                         Margin="0,5" SelectedIndex="1" SelectionChanged="ScreenComboBox_SelectionChanged">
                                </ComboBox>

                                <!-- Auto OCR -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_AutoOCR]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="AutoOCRCheckBox" Grid.Row="2" Grid.Column="1" 
                                         Checked="AutoOCRCheckBox_CheckedChanged" 
                                         Unchecked="AutoOCRCheckBox_CheckedChanged"
                                         ToolTip="Auto OCR realtime, turn off this feature the program will not auto translate"/>
                                
                                <!-- Manga Mode -->
                                <!-- <TextBlock Text="Manga Mode (Beta):" Grid.Row="10" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="MangaModeCheckBox" Grid.Row="10" Grid.Column="1" 
                                         Checked="MangaModeCheckBox_CheckedChanged" 
                                         Unchecked="MangaModeCheckBox_CheckedChanged"
                                         ToolTip="This mode helps translate and display manga more accurately (currently only supports manga with horizontal text), but it will reduce translation speed."/> -->
                            </Grid>
                        </GroupBox>
                        
                        <!-- OCR Methods Comparison -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_OCRComparison]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.Resources>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Padding" Value="5"/>
                                    </Style>
                                    <Style TargetType="Border">
                                        <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
                                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                        <Setter Property="Padding" Value="2"/>
                                    </Style>
                                </Grid.Resources>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/> <!-- Method Name -->
                                    <ColumnDefinition Width="Auto"/> <!-- Install -->
                                    <ColumnDefinition Width="Auto"/> <!-- Speed -->
                                    <ColumnDefinition Width="Auto"/> <!-- Accuracy -->
                                    <ColumnDefinition Width="Auto"/> <!-- Support Manga -->
                                    <ColumnDefinition Width="Auto"/> <!-- Resources needed -->
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/> <!-- Header -->
                                    <RowDefinition Height="Auto"/> <!-- Windows OCR -->
                                    <RowDefinition Height="Auto"/> <!-- OneOCR -->
                                    <RowDefinition Height="Auto"/> <!-- RapidOCR -->
                                    <RowDefinition Height="Auto"/> <!-- EasyOCR -->
                                    <RowDefinition Height="Auto"/> <!-- PaddleOCR -->
                                </Grid.RowDefinitions>

                                <!-- Header Row -->
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_Method]}" FontWeight="Bold"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_Install]}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_Speed]}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock Grid.Row="0" Grid.Column="3" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_Accuracy]}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock Grid.Row="0" Grid.Column="4" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_SupportManga]}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock Grid.Row="0" Grid.Column="5" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_Resources]}" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <Border Grid.Row="0" Grid.ColumnSpan="6" BorderThickness="0,0,0,2" BorderBrush="#FF888888" Margin="0,0,0,5"/>

                                <!-- Windows OCR -->
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Windows OCR"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="No" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="Very Fast" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="1" Grid.Column="3" Text="Medium" HorizontalAlignment="Center" Foreground="#FFA500"/> <!-- Orange -->
                                <TextBlock Grid.Row="1" Grid.Column="4" Text="No" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="1" Grid.Column="5" Text="CPU(~2%)" HorizontalAlignment="Center" Foreground="Black"/>
                                <Border Grid.Row="1" Grid.ColumnSpan="6"/>

                                <!-- OneOCR -->
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="OneOCR"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="No" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="2" Grid.Column="2" Text="Fast" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="2" Grid.Column="3" Text="High" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="2" Grid.Column="4" Text="Yes" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="2" Grid.Column="5" Text="CPU(~10%)" HorizontalAlignment="Center" Foreground="Black"/>
                                <Border Grid.Row="2" Grid.ColumnSpan="6"/>

                                <!-- RapidOCR -->
                                <TextBlock Grid.Row="3" Grid.Column="0" Text="RapidOCR"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="Yes" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="3" Grid.Column="2" Text="Fast" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="3" Grid.Column="3" Text="Very High" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="3" Grid.Column="4" Text="No" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="3" Grid.Column="5" Text="AMD/NVIDIA(~10%)" HorizontalAlignment="Center" Foreground="Black"/>
                                <Border Grid.Row="3" Grid.ColumnSpan="6"/>

                                <!-- EasyOCR -->
                                <TextBlock Grid.Row="4" Grid.Column="0" Text="EasyOCR"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="Yes" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="4" Grid.Column="2" Text="Medium" HorizontalAlignment="Center" Foreground="#FFA500"/>
                                <TextBlock Grid.Row="4" Grid.Column="3" Text="Good" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="4" Grid.Column="4" Text="No" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="4" Grid.Column="5" Text="NVIDIA(~20%)" HorizontalAlignment="Center" Foreground="Black"/>
                                <Border Grid.Row="4" Grid.ColumnSpan="6"/>

                                <!-- PaddleOCR -->
                                <TextBlock Grid.Row="5" Grid.Column="0" Text="PaddleOCR"/>
                                <TextBlock Grid.Row="5" Grid.Column="1" Text="Yes" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="5" Grid.Column="2" Text="Fast" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="5" Grid.Column="3" Text="Very High" HorizontalAlignment="Center" Foreground="Green"/>
                                <TextBlock Grid.Row="5" Grid.Column="4" Text="No" HorizontalAlignment="Center" Foreground="Black"/>
                                <TextBlock Grid.Row="5" Grid.Column="5" Text="NVIDIA(~15%)" HorizontalAlignment="Center" Foreground="Black"/>
                                <Border Grid.Row="5" Grid.ColumnSpan="6" BorderThickness="0"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- OCR Settings Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_OCRSettings]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- OCR Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_OCRSettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Block Power -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_BlockPower]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="If higher, text is more likely to be glued together to make a large paragraph. Lower does the opposite, good for say, tiny buttons or menu options. Also affects character-level grouping."/>
                                <TextBox x:Name="blockDetectionPowerTextBox" Grid.Row="0" Grid.Column="1" 
                                        Margin="0,5" Text="5" LostFocus="BlockDetectionPowerTextBox_LostFocus"
                                        ToolTip="If higher, text is more likely to be glued together to make a large paragraph. Lower does the opposite, good for say, tiny buttons or menu options. Also affects character-level grouping."/>
                                
                                <!-- Settle Time -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SettleTime]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Time in seconds to wait for the text to settle before capturing"/>
                                <TextBox x:Name="settleTimeTextBox" Grid.Row="1" Grid.Column="1" 
                                        Margin="0,5" Text="0.5" LostFocus="SettleTimeTextBox_LostFocus"
                                        ToolTip="Time in seconds to wait for the text to settle before capturing"/>

                                <!-- TextSimilar Threshold-->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_TextSimilarThreshold]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Check the similarity between two consecutive texts. &#x0a;For example, 0.5 is equivalent to 50% - if text 1 has a similarity greater than or equal to 50%, it will be skipped."/>
                                <TextBox x:Name="textSimilarThresholdTextBox" Grid.Row="2" Grid.Column="1" 
                                        Margin="0,5" Text="0.75" LostFocus="TextSimilarThresholdTextBox_LostFocus"
                                        ToolTip="Check the similarity between two consecutive texts. &#x0a;For example, 0.5 is equivalent to 50% - if text 1 has a similarity greater than or equal to 50%, it will be skipped."/>
                                
                                <!-- Char Level Checkbox-->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_CharLevel]}" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Split OCR result to character"/>
                                <CheckBox x:Name="charLevelCheckBox" Grid.Row="3" Grid.Column="1" 
                                         Margin="0,5" IsChecked="True" 
                                         Checked="CharLevelCheckBox_CheckedChanged" 
                                         Unchecked="CharLevelCheckBox_CheckedChanged"/>
                                
                                <!-- Minimum Text Fragment Size -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MinTextFragmentSize]}" Grid.Row="4" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Minimum number of characters for a text fragment to be processed. Smaller fragments will be ignored."/>
                                <TextBox x:Name="minTextFragmentSizeTextBox" Grid.Row="4" Grid.Column="1" 
                                        Margin="0,5" Text="2" LostFocus="MinTextFragmentSizeTextBox_LostFocus"
                                        ToolTip="Minimum number of characters for a text fragment to be processed. Smaller fragments will be ignored."/>
                                
                                <!-- Minimum Letter Confidence -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MinLetterConfidence]}" Grid.Row="5" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Minimum confidence threshold for individual letters/characters (0.0-1.0). Characters with confidence below this threshold will be filtered out."/>
                                <TextBox x:Name="minLetterConfidenceTextBox" Grid.Row="5" Grid.Column="1" 
                                        Margin="0,5" Text="0.1" LostFocus="MinLetterConfidenceTextBox_LostFocus"
                                        ToolTip="Minimum confidence threshold for individual letters/characters (0.0-1.0). Characters with confidence below this threshold will be filtered out."/>
                                
                                <!-- Minimum Line Confidence -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MinLineConfidence]}" Grid.Row="6" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Minimum confidence threshold for text lines (0.0-1.0). Lines with average confidence below this threshold will be filtered out."/>
                                <TextBox x:Name="minLineConfidenceTextBox" Grid.Row="6" Grid.Column="1" 
                                        Margin="0,5" Text="0.2" LostFocus="MinLineConfidenceTextBox_LostFocus"
                                        ToolTip="Minimum confidence threshold for text lines (0.0-1.0). Lines with average confidence below this threshold will be filtered out."/>
                                
                                <!-- Auto Translate -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_AutoTranslate]}" Grid.Row="7" Grid.Column="0" Visibility="Collapsed"
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="autoTranslateCheckBox" Grid.Row="7" Grid.Column="1" Visibility="Collapsed"
                                         Margin="0,5" IsChecked="True" 
                                         Checked="AutoTranslateCheckBox_CheckedChanged" 
                                         Unchecked="AutoTranslateCheckBox_CheckedChanged"/>
                                         
                                
                                <!-- Multi Selection Area -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MultiSelection]}" Grid.Row="8" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"
                                    ToolTip="Enable multi selection area for text selection."/>
                                <CheckBox x:Name="multiSelectionAreaCheckBox" Grid.Row="8" Grid.Column="1" Margin="0,5"
                                         Checked="MultiSelectionAreaCheckBox_CheckedChanged"
                                         Unchecked="MultiSelectionAreaCheckBox_CheckedChanged"/>

                                <!-- Leave Translation Onscreen -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_LeaveOnscreen]}" Grid.Row="9" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Always show the translation on the Monitor window and don't bother showing the source language, makes it easier to read translations while new ones are being made"/>
                                <CheckBox x:Name="leaveTranslationOnscreenCheckBox" Grid.Row="9" Grid.Column="1" 
                                         Margin="0,5" IsChecked="False" 
                                         Checked="LeaveTranslationOnscreenCheckBox_CheckedChanged" 
                                         Unchecked="LeaveTranslationOnscreenCheckBox_CheckedChanged"
                                         ToolTip="Always show the translation on the Monitor window and don't bother showing the source language, makes it easier to read translations while new ones are being made"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Translation Context Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_ContextOverlay]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Translation Context Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ContextSettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Context Settings -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MaxContext]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Maximum number of previous text pieces to include as context. Set to 0 to disable context."/>
                                <TextBox x:Name="maxContextPiecesTextBox" Grid.Row="0" Grid.Column="1" 
                                        Margin="0,5" Text="3" LostFocus="MaxContextPiecesTextBox_LostFocus"
                                        ToolTip="Maximum number of previous text pieces to include as context. Set to 0 to disable context."/>
                                
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MinContextSize]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Minimum size in characters for a text piece to be included as context. Helps avoid adding tiny menu labels or buttons as context."/>
                                <TextBox x:Name="minContextSizeTextBox" Grid.Row="1" Grid.Column="1" 
                                        Margin="0,5" Text="20" LostFocus="MinContextSizeTextBox_LostFocus"
                                        ToolTip="Minimum size in characters for a text piece to be included as context. Helps avoid adding tiny menu labels or buttons as context."/>
                                        
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MinChatBoxSize]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="Minimum size in characters for text to be shown in ChatBox. Smaller text will be ignored."/>
                                <TextBox x:Name="minChatBoxTextSizeTextBox" Grid.Row="2" Grid.Column="1" 
                                        Margin="0,5" Text="2" LostFocus="MinChatBoxTextSizeTextBox_LostFocus"
                                        ToolTip="Minimum size in characters for text to be shown in ChatBox. Smaller text will be ignored."/>
                                
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_GameInfo]}" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" 
                                          ToolTip="Information about the game being played to help the LLM translate more accurately."/>
                                <TextBox x:Name="gameInfoTextBox" Grid.Row="3" Grid.Column="1" 
                                        Margin="0,5" TextChanged="GameInfoTextBox_TextChanged"
                                        ToolTip="Information about the game being played to help the LLM translate more accurately."
                                        AcceptsReturn="True" TextWrapping="Wrap" Height="60" VerticalScrollBarVisibility="Auto"/>
                                
                                <!-- Clear Context Button -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ClearContext]}" Grid.Row="4" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,8,10,0"
                                          ToolTip="Clear all translation history and context. Forces new translation on next capture."/>
                                <Button x:Name="clearContextButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ClearContext]}" Grid.Row="4" Grid.Column="1"
                                       HorizontalAlignment="Left" Width="100" Margin="0,8,0,10" Padding="5,3" Click="ClearContextButton_Click"
                                       ToolTip="Clear all translation history and context. Forces new translation on next capture."/>
                            </Grid>
                        </GroupBox>
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_OverlaySettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <!-- Clear Context Button -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_OverlayConfig]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,8,10,0"
                                          ToolTip="Adjust overlay background and text colour"/>
                                <Button x:Name="overlayConfig" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_AdjustConfig]}" Grid.Row="0" Grid.Column="1"
                                       HorizontalAlignment="Left" Width="100" Margin="20,8,0,10" Padding="5,3" Click="AdjustOverlayConfig_Click"
                                       ToolTip="Adjust overlay background and text colour"/>
                                <!-- Auto Set Overlay Background Color Checkbox-->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_AutoOverlayBg]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,8,10,0"
                                          ToolTip="Smart select background color for overlay base on image"/>
                                <CheckBox x:Name="autoSetOverlayBackgroundColorcheckBox" Grid.Row="1" Grid.Column="1" 
                                         Margin="20,8,0,0" IsChecked="True" Padding="5,3"
                                         Checked="AutoSetOverlayBackgroundColorcheckBox_CheckedChanged" 
                                         Unchecked="AutoSetOverlayBackgroundColorcheckBox_CheckedChanged"/>
                                
                                <!-- Show Icon Signal When Start OCR -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ShowIconSignal]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,8,10,0" 
                                          ToolTip="Show small icon when starting OCR and translate"/>
                                <CheckBox x:Name="showIconSignalCheckBox" Grid.Row="2" Grid.Column="1" 
                                         Margin="20,8,0,0" IsChecked="True" Padding="5,3"
                                         Checked="ShowIconSignal_CheckedChanged" 
                                         Unchecked="ShowIconSignal_CheckedChanged"/>
                                
                                <!-- Auto Merge Overlapping Text -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_AutoMergeOverlappingText]}" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,8,10,0" 
                                          ToolTip="Automatically merge text blocks that would overlap when translation is longer than original text"/>
                                <CheckBox x:Name="autoMergeOverlappingTextCheckBox" Grid.Row="3" Grid.Column="1" 
                                         Margin="20,8,0,0" IsChecked="True" Padding="5,3"
                                         Checked="AutoMergeOverlappingTextCheckBox_CheckedChanged" 
                                         Unchecked="AutoMergeOverlappingTextCheckBox_CheckedChanged"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Ignore Phrases Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_IgnorePhrases]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Ignore Phrases Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_IgnorePhrases]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Header for list -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_PhrasesToIgnore]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          ToolTip="List of phrases that will be ignored during translation. If exact match is enabled, the whole text will be ignored if it matches. If disabled, the phrase will be removed from the text."/>
                                
                                <!-- ListView for phrases -->
                                <ListView x:Name="ignorePhraseListView" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4"
                                         Margin="0,5" Height="300" SelectionMode="Single" SelectionChanged="IgnorePhraseListView_SelectionChanged">
                                    <ListView.View>
                                        <GridView>
                                            <GridViewColumn Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_Phrase]}" Width="350" DisplayMemberBinding="{Binding Phrase}"/>
                                            <GridViewColumn Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Col_ExactMatch]}" Width="100">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <CheckBox IsChecked="{Binding ExactMatch}" Checked="IgnorePhrase_CheckedChanged" Unchecked="IgnorePhrase_CheckedChanged" Tag="{Binding Phrase}"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                                
                                <!-- Input for new phrase -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_AddPhrase]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,8,10,0"/>
                                <TextBox x:Name="newIgnorePhraseTextBox" Grid.Row="2" Grid.Column="1" 
                                        Margin="0,8,10,0"/>
                                <CheckBox x:Name="newExactMatchCheckBox" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_ExactMatch]}" Grid.Row="2" Grid.Column="2" 
                                         VerticalAlignment="Center" Margin="0,8,10,0" IsChecked="True"/>
                                <StackPanel Orientation="Horizontal" Grid.Row="2" Grid.Column="3">
                                    <Button x:Name="addIgnorePhraseButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_Add]}" Margin="0,8,5,0" Width="60" Click="AddIgnorePhraseButton_Click"/>
                                    <Button x:Name="removeIgnorePhraseButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_Remove]}" Margin="0,8,0,0" Width="60" Click="RemoveIgnorePhraseButton_Click" IsEnabled="False"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Exclude Regions Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_ExcludeRegions]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Exclude Regions Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ExcludeRegions]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Description -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ExcludeRegionsDesc]}" 
                                           Grid.Row="0" Grid.Column="0" Margin="0,0,0,10"
                                           TextWrapping="Wrap" Foreground="{DynamicResource MutedBrush}" FontSize="12"/>

                                <!-- List of exclude regions -->
                                <ListBox x:Name="excludeRegionsListView" Grid.Row="2" Grid.Column="0" 
                                         Margin="0,5" Height="200" SelectionMode="Single"
                                         Background="{DynamicResource Surface2Brush}"
                                         Foreground="{DynamicResource TextBrush}"
                                         BorderBrush="{DynamicResource BorderBrush}">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Foreground="{DynamicResource TextBrush}">
                                                <Run Text="Region: "/>
                                                <Run Text="X="/><Run Text="{Binding X}"/><Run Text=", "/>
                                                <Run Text="Y="/><Run Text="{Binding Y}"/><Run Text=", "/>
                                                <Run Text="W="/><Run Text="{Binding Width}"/><Run Text=", "/>
                                                <Run Text="H="/><Run Text="{Binding Height}"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>

                                <!-- Buttons -->
                                <StackPanel Orientation="Horizontal" Grid.Row="3" Grid.Column="0" Margin="0,10,0,0">
                                    <Button x:Name="addExcludeRegionButton" 
                                            Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_AddExcludeRegion]}"
                                            Margin="0,0,10,0" Width="120" Click="AddExcludeRegionButton_Click"/>
                                    <Button x:Name="clearExcludeRegionsButton" 
                                            Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ClearExcludeRegions]}"
                                            Margin="0,0,10,0" Width="100" Click="ClearExcludeRegionsButton_Click"/>
                                    <CheckBox x:Name="showExcludeRegionsCheckBox" Visibility="Collapsed"
                                              Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ShowExcludeRegions]}"
                                              VerticalAlignment="Center" Margin="20,0,0,0"
                                              Checked="ShowExcludeRegionsCheckBox_Checked" Unchecked="ShowExcludeRegionsCheckBox_Unchecked"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Translation Service Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_Translation]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Translation Service Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_TranslationService]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Translation Service -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_TranslationService]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="translationServiceComboBox" Grid.Row="0" Grid.Column="1" 
                                         Margin="0,5" SelectedIndex="0" SelectionChanged="TranslationServiceComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Gemini"/>
                                    <ComboBoxItem Content="Groq"/>
                                    <ComboBoxItem Content="Ollama"/>
                                    <ComboBoxItem Content="ChatGPT"/>
                                    <ComboBoxItem Content="Mistral"/>
                                    <ComboBoxItem Content="Google Translate"/>
                                    <ComboBoxItem Content="Yandex"/>
                                    <ComboBoxItem Content="LM Studio"/>
                                    <ComboBoxItem Content="Microsoft"/>
                                    <ComboBoxItem Content="Custom API"/>
                                </ComboBox>
                                
                                <!-- Gemini API Key - Only visible when Gemini is selected -->
                                <TextBlock x:Name="geminiApiKeyLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_GeminiKey]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0"/>
                                <Grid Grid.Row="1" Grid.Column="1" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="geminiApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="GeminiApiKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown" 
                                             Tag="Gemini"/>
                                    <Button x:Name="viewGeminiKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewKeys]}" Grid.Row="1" HorizontalAlignment="Right"
                                             Click="ViewApiKeysButton_Click" Tag="Gemini" Width="70"/>
                                    <Button x:Name="SaveGeminiKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SaveKeys]}" Grid.Row="1" Tag="Gemini"
                                            HorizontalAlignment="Left" Width="70" Click="SaveApiKeysButton_Click" />
                                    <TextBlock x:Name="geminiApiKeyHelpText" Grid.Row="2" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Get API key from </Run>
                                        <Hyperlink Click="GeminiApiLink_Click">https://ai.google.dev/tutorials/setup</Hyperlink>
                                    </TextBlock>
                                </Grid>

                                <!-- Groq API Key - Only visible when Groq is selected -->
                                <TextBlock x:Name="groqApiKeyLabel" Text="Groq API Key:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0"/>
                                <Grid Grid.Row="1" Grid.Column="1" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="groqApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="GroqApiKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown" 
                                             Tag="Groq"/>
                                    <Button x:Name="viewGroqKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewKeys]}" Grid.Row="1" HorizontalAlignment="Right"
                                             Click="ViewApiKeysButton_Click" Tag="Groq" Width="70"/>
                                    <Button x:Name="SaveGroqKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SaveKeys]}" Grid.Row="1" Tag="Groq"
                                            HorizontalAlignment="Left" Width="70" Click="SaveApiKeysButton_Click" />
                                    <TextBlock x:Name="groqApiKeyHelpText" Grid.Row="2" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Get API key from </Run>
                                        <Hyperlink Click="GroqApiLink_Click">https://console.groq.com/keys</Hyperlink>
                                    </TextBlock>
                                </Grid>

                                <!-- Microsoft Legacy Key - Only visible when Microsoft is selected -->
                                <TextBlock x:Name="microsoftApiKeyLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MicrosoftLegacyKey]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" Visibility="Collapsed"/>
                                <Grid Grid.Row="1" Grid.Column="1" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="microsoftLegacyKeyPasswordBox" Grid.Row="0" Visibility="Collapsed"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="MicrosoftLegacyKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown" 
                                             Tag="Microsoft"/>
                                    <Button x:Name="viewMicrosoftKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewKeys]}" Grid.Row="1" HorizontalAlignment="Right"
                                             Click="ViewApiKeysButton_Click" Tag="Microsoft" Width="70" Visibility="Collapsed"/>
                                    <Button x:Name="SaveMicrosoftKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SaveKeys]}" Grid.Row="1" Tag="Microsoft"
                                            HorizontalAlignment="Left" Width="70" Click="SaveApiKeysButton_Click" Visibility="Collapsed" />
                                    <CheckBox x:Name="microsoftLegacyModeCheckBox" Grid.Row="2" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_MicrosoftLegacyMode]}" IsChecked="True" Checked="MicrosoftLegacyModeCheckBox_CheckedChanged" Unchecked="MicrosoftLegacyModeCheckBox_CheckedChanged" />
                                </Grid>

                                <!-- Custome API url - Only visible when Custom API is selected -->
                                <TextBlock x:Name="customApiUrlLabel" Text="Custom API URL:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0"/>
                                <Grid Grid.Row="1" Grid.Column="1" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBox x:Name="customApiUrlTextBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             LostFocus="CustomApiUrlTextBox_LostFocus"
                                             TextChanged="CustomApiUrlTextBox_TextChanged"/>
                                </Grid>

                                <!-- Custom API Key - Only visible when Custom API is selected -->
                                <TextBlock x:Name="customApiKeyLabel" Text="Custom API Key:" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="customApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="CustomApiKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown" 
                                             Tag="Custom"/>
                                    <Button x:Name="viewCustomApiKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewKeys]}" Grid.Row="1" HorizontalAlignment="Right"
                                             Click="ViewApiKeysButton_Click" Tag="Custom" Width="70"/>
                                    <Button x:Name="SaveCustomApiKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SaveKeys]}" Grid.Row="1" Tag="Custom"
                                            HorizontalAlignment="Left" Width="70" Click="SaveApiKeysButton_Click" />
                                </Grid>
                                
                                <!-- Gemini Model - Only visible when Gemini is selected -->
                                <TextBlock x:Name="geminiModelLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_GeminiModel]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Margin="0,5" x:Name="geminiModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox x:Name="geminiModelComboBox" Grid.Column="0"
                                            SelectionChanged="GeminiModelComboBox_SelectionChanged"
                                            LostFocus="GeminiModelComboBox_LostFocus"
                                            IsEditable="True">
                                        <ComboBoxItem Content="gemini-2.0-flash"/>
                                        <ComboBoxItem Content="gemini-2.0-flash-lite"/>
                                        <ComboBoxItem Content="gemma-3-12b-it"/>
                                        <ComboBoxItem Content="gemma-3-27b-it"/>
                                        <ComboBoxItem Content="gemini-2.5-flash"/>
                                        <ComboBoxItem Content="gemini-2.5-flash-lite"/>
                                        <ComboBoxItem Content="gemini-flash-lite-latest"/>
                                        <ComboBoxItem Content="gemini-flash-latest"/>
                                    </ComboBox>
                                    <Button x:Name="viewGeminiModelsButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewModels]}" Grid.Column="1"
                                           Margin="5,0,0,0" Padding="5,0" Click="ViewGeminiModelsButton_Click"
                                           ToolTip="Open Gemini models documentation in browser"/>
                                </Grid>

                                <!-- Groq Model - Only visible when Groq is selected -->
                                <TextBlock x:Name="groqModelLabel" Text="Groq Model:" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Margin="0,5" x:Name="groqModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox x:Name="groqModelComboBox" Grid.Column="0"
                                            SelectionChanged="GroqModelComboBox_SelectionChanged"
                                            LostFocus="GroqModelComboBox_LostFocus"
                                            IsEditable="True">
                                        <ComboBoxItem Content="qwen/qwen3-32b"/>
                                        <ComboBoxItem Content="openai/gpt-oss-20b"/>
                                        <ComboBoxItem Content="openai/gpt-oss-120b"/>
                                        <ComboBoxItem Content="moonshotai/kimi-k2-instruct"/>
                                        <ComboBoxItem Content="moonshotai/kimi-k2-instruct-0905"/>
                                        <ComboBoxItem Content="meta-llama/llama-prompt-guard-2-86m"/>
                                        <ComboBoxItem Content="meta-llama/llama-prompt-guard-2-22m"/>
                                        <ComboBoxItem Content="meta-llama/llama-guard-4-12b"/>
                                    </ComboBox>
                                    <Button x:Name="viewGroqModelsButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewModels]}" Grid.Column="1"
                                           Margin="5,0,0,0" Padding="5,0" Click="ViewGroqModelsButton_Click"
                                           ToolTip="Open Groq models documentation in browser"/>
                                </Grid>

                                <!-- Custom Api Model - Only visible when Custom Api is selected -->
                                <TextBlock x:Name="customApiModelLabel" Text="Custom Api Model:" Grid.Row="3" Grid.Column="0"
                                          VerticalAlignment="Center" Margin="0,5,10,0"/>
                                <Grid Grid.Row="3" Grid.Column="1" Margin="0,5" x:Name="customApiModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="customApiModelTextBox" Grid.Column="0"
                                            VerticalAlignment="Top" Margin="0,0,0,2" LostFocus="CustomApiModelTextBox_LostFocus"
                                            TextChanged="CustomApiModelTextBox_TextChanged"/>
                                </Grid>

                                <!-- Custom API Note - Only visible when Custom API is selected -->
                                <TextBlock x:Name="customApiNoteTextBlock" Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2"
                                          Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_CustomApiNote]}"
                                          VerticalAlignment="Top" Margin="0,8,0,0"
                                          TextWrapping="Wrap"
                                          Foreground="#FFA0A0A0"
                                          FontSize="11"/>
                                
                                <!-- Mistral Model - Only visible when Mistral is selected -->
                                <TextBlock x:Name="mistralModelLabel" Text="Mistral Model:" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Margin="0,5" x:Name="mistralModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox x:Name="mistralModelComboBox" Grid.Column="0"
                                            SelectionChanged="MistralModelComboBox_SelectionChanged"
                                            LostFocus="MistralModelComboBox_LostFocus"
                                            IsEditable="True">
                                        <ComboBoxItem Content="mistral-medium"/>
                                        <ComboBoxItem Content="open-mistral-nemo"/>
                                        <ComboBoxItem Content="mistral-small-2503"/>
                                    </ComboBox>
                                    <Button x:Name="viewMistralModelsButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewModels]}" Grid.Column="1"
                                           Margin="5,0,0,0" Padding="5,0" Click="ViewMistralModelsButton_Click"
                                           ToolTip="Open Mistral models documentation in browser"/>
                                </Grid>

                                <!-- Mistral API Key - Only visible when Mistral is selected -->
                                <TextBlock x:Name="mistralApiKeyLabel" Text="Mistral API Key:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0"/>
                                <Grid Grid.Row="1" Grid.Column="1" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="mistralApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="MistralApiKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown" 
                                             Tag="Mistral"/>
                                    <Button x:Name="viewMistralKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_ViewKeys]}" Grid.Row="1" HorizontalAlignment="Right"
                                             Click="ViewApiKeysButton_Click" Tag="Mistral" Width="70"/>
                                    <Button x:Name="SaveMistralKeysButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SaveKeys]}" Grid.Row="1" Tag="Mistral"
                                            HorizontalAlignment="Left" Width="70" Click="SaveApiKeysButton_Click" />
                                    <TextBlock x:Name="mistralApiKeyHelpText" Grid.Row="2" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Get API key from (need login mistral AI website before click this link) </Run>
                                        <Hyperlink Click="MistralApiLink_Click">https://admin.mistral.ai/organization/api-keys</Hyperlink>
                                    </TextBlock>
                                </Grid>
                                
                                <!-- Ollama URL - Only visible when Ollama is selected -->
                                <TextBlock x:Name="ollamaUrlLabel" Text="Ollama URL:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" Visibility="Collapsed"/>
                                <Grid Grid.Row="1" Grid.Column="1" Visibility="Collapsed" x:Name="ollamaUrlGrid" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBox x:Name="ollamaUrlTextBox" Grid.Row="0"
                                            VerticalAlignment="Top" Margin="0,0,0,2" Text="http://localhost"
                                            TextChanged="OllamaUrlTextBox_TextChanged"/>
                                    <TextBlock Grid.Row="1" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Download Ollama from </Run>
                                        <Hyperlink Click="OllamaDownloadLink_Click">https://ollama.com</Hyperlink>
                                    </TextBlock>
                                </Grid>
                                
                                <!-- Ollama Port - Only visible when Ollama is selected -->
                                <TextBlock x:Name="ollamaPortLabel" Text="Ollama Port:" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"/>
                                <TextBox x:Name="ollamaPortTextBox" Grid.Row="2" Grid.Column="1" 
                                        Margin="0,5" Text="11434" Visibility="Collapsed"
                                        TextChanged="OllamaPortTextBox_TextChanged"/>
                                
                                <!-- Ollama Model - Only visible when Ollama is selected -->
                                <TextBlock x:Name="ollamaModelLabel" Text="Ollama Model:" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"
                                          ToolTip="The model to use for translation (e.g. llama3, llama3:8b, phi3, phi3:mini)"/>
                                <Grid Grid.Row="3" Grid.Column="1" Margin="0,5" Visibility="Collapsed" x:Name="ollamaModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="ollamaModelTextBox" Grid.Column="0"
                                            Text="llama3" TextChanged="OllamaModelTextBox_TextChanged"
                                            ToolTip="Common models: llama3, llama3:8b, phi3, phi3:mini, mistral, mixtral, gemma2, neural-chat"/>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <Button x:Name="testModelButton" Content="Test &amp; Download" 
                                               Margin="5,0,5,0" Padding="5,0" Click="TestModelButton_Click"
                                               ToolTip="Test if the model exists and download it if needed"/>
                                        <Button x:Name="viewModelsButton" Content="View Models" 
                                               Margin="0,0,0,0" Padding="5,0" Click="ViewModelsButton_Click"
                                               ToolTip="Open Ollama models gallery in browser"/>
                                    </StackPanel>
                                </Grid>

                                <!-- LM Studio URL - Only visible when LM Studio is selected -->
                                <TextBlock x:Name="lmstudioUrlLabel" Text="LM Studio URL:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" Visibility="Collapsed"/>
                                <Grid Grid.Row="1" Grid.Column="1" Visibility="Collapsed" x:Name="lmstudioUrlGrid" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <TextBox x:Name="lmstudioUrlTextBox" Grid.Row="0"
                                            VerticalAlignment="Top" Margin="0,0,0,2"
                                            TextChanged="LMStudioUrlTextBox_TextChanged"/>
                                    <TextBlock Grid.Row="1" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Download LM Studio from </Run>
                                        <Hyperlink Click="LMStudioDownloadLink_Click">https://lmstudio.ai/download</Hyperlink>
                                    </TextBlock>
                                </Grid>
                                
                                <!-- LM Studio Port - Only visible when LM Studio is selected -->
                                <TextBlock x:Name="lmstudioPortLabel" Text="LM Studio Port:" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"/>
                                <TextBox x:Name="lmstudioPortTextBox" Grid.Row="2" Grid.Column="1" 
                                        Margin="0,5" Visibility="Collapsed"
                                        TextChanged="LMStudioPortTextBox_TextChanged"/>
                                
                                <!-- LM Studio Model - Only visible when LM Studio is selected -->
                                <TextBlock x:Name="lmstudioModelLabel" Text="LM Studio Model:" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"
                                          ToolTip="The model to use for translation (e.g: google/gemma-3-12b)"/>
                                <Grid Grid.Row="3" Grid.Column="1" Margin="0,5" Visibility="Collapsed" x:Name="lmstudioModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="lmstudioModelTextBox" Grid.Column="0"
                                             TextChanged="LMStudioModelTextBox_TextChanged"/>
                                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                                        <Button x:Name="viewModelLMStudiosButton" Content="View Models" 
                                               Margin="0,0,0,0" Padding="5,0" Click="ViewModelsButtonLMStudio_Click"
                                               ToolTip="Open LM Studio models gallery in browser"/>
                                    </StackPanel>
                                </Grid>
                                
                                <!-- ChatGPT API Key - Only visible when ChatGPT is selected -->
                                <TextBlock x:Name="chatGptApiKeyLabel" Text="ChatGPT API Key:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" Visibility="Collapsed"/>
                                <Grid Grid.Row="1" Grid.Column="1" Visibility="Collapsed" x:Name="chatGptApiKeyGrid" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="chatGptApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="ChatGptApiKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown"
                                             Tag="ChatGPT"/>
                                    <Button x:Name="viewChatGptKeysButton" Content="View Keys" Grid.Row="1" HorizontalAlignment="Right"
                                             Click="ViewApiKeysButton_Click" Tag="ChatGPT" Width="70"/>
                                    <Button x:Name="SaveChatGptKeysButton" Content="Save Keys" Grid.Row="1" Tag="ChatGPT"
                                            HorizontalAlignment="Left" Width="70" Click="SaveApiKeysButton_Click" />
                                    <TextBlock Grid.Row="2" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Get API key from </Run>
                                        <Hyperlink Click="ChatGptApiLink_Click">https://platform.openai.com/api-keys</Hyperlink>
                                    </TextBlock>
                                </Grid>
                                
                                <!-- ChatGPT Model - Only visible when ChatGPT is selected -->
                                <TextBlock x:Name="chatGptModelLabel" Text="ChatGPT Model:" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"
                                          ToolTip="The OpenAI model to use for translation"/>
                                <Grid Grid.Row="3" Grid.Column="1" Margin="0,5" Visibility="Collapsed" x:Name="chatGptModelGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox x:Name="chatGptModelComboBox" Grid.Column="0"
                                            SelectionChanged="ChatGptModelComboBox_SelectionChanged">
                                        <ComboBoxItem Content="GPT-4.1" Tag="gpt-4.1"/>
                                        <ComboBoxItem Content="GPT-5.1" Tag="gpt-5.1"/>
                                        <ComboBoxItem Content="GPT-4.1 Nano" Tag="gpt-4.1-nano"/>
                                        <ComboBoxItem Content="GPT-4.1 Mini" Tag="gpt-4.1-mini"/>
                                        <ComboBoxItem Content="GPT-5-Mini" Tag="gpt-5-mini"/>
                                    </ComboBox>
                                    <Button x:Name="viewChatGptModelsButton" Content="View Models" Grid.Column="1"
                                           Margin="5,0,0,0" Padding="5,0" Click="ViewChatGptModelsButton_Click"
                                           ToolTip="Open OpenAI models documentation in browser"/>
                                </Grid>
                                
                                <!-- Google Translate API Key - Only visible when Google Translate is selected -->
                                <TextBlock x:Name="googleTranslateApiKeyLabel" Text="Google Cloud API Key:" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" Visibility="Collapsed"/>
                                <Grid Grid.Row="1" Grid.Column="1" Visibility="Collapsed" x:Name="googleTranslateApiKeyGrid" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="googleTranslateApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="GoogleTranslateApiKeyPasswordBox_PasswordChanged" KeyDown="ApiKeyPasswordBox_KeyDown"
                                             Tag="Google Translate"/>
                                    <Button x:Name="viewGoogleTranslateKeysButton" Content="View Keys" Grid.Row="1" 
                                             Click="ViewApiKeysButton_Click" Tag="Google Translate" Width="70" Visibility="Collapsed"/>
                                    <TextBlock Grid.Row="2" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Get API key from </Run>
                                        <Hyperlink Click="GoogleTranslateApiLink_Click">https://cloud.google.com/translate/docs/setup</Hyperlink>
                                    </TextBlock>
                                </Grid>

                                <!-- Google Translate Service Type - Only visible when Google Translate is selected -->
                                <TextBlock x:Name="googleTranslateServiceTypeLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_GoogleTranslateServiceType]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"
                                          ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_GoogleTranslateServiceTypeToolTip]}"/>
                                <ComboBox x:Name="googleTranslateServiceTypeComboBox" Grid.Row="2" Grid.Column="1" 
                                         Margin="0,5" Visibility="Collapsed" SelectionChanged="GoogleTranslateServiceTypeComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Free Web Service"/>
                                    <ComboBoxItem Content="Cloud API (paid)"/>
                                </ComboBox>
                                
                                <!-- Google Translate Language Mapping -->
                                <TextBlock x:Name="googleTranslateMappingLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_LanguageMapping]}" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"
                                          ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_PromptTemplateToolTip]}"/>
                                <CheckBox x:Name="googleTranslateMappingCheckBox" Grid.Row="3" Grid.Column="1" 
                                         Margin="0,5" IsChecked="True" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_AutoMapLanguageCodes]}" Visibility="Collapsed"
                                         Checked="GoogleTranslateMappingCheckBox_CheckedChanged" 
                                         Unchecked="GoogleTranslateMappingCheckBox_CheckedChanged"
                                         ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_PromptTemplateToolTip]}"/>
                                
                                <!-- Prompt Label -->
                                <TextBlock x:Name="promptLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Chk_PromptTemplate]}" Grid.Row="5" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,10,10,0"/>
                                
                                <!-- Prompt Editor -->
                                <TextBox x:Name="promptTemplateTextBox" Grid.Row="5" Grid.Column="1" 
                                        Margin="0,10,0,0" AcceptsReturn="True" TextWrapping="Wrap"
                                        MinHeight="150" MaxHeight="300" VerticalScrollBarVisibility="Auto"
                                        FontFamily="Consolas" FontSize="12" 
                                        LostFocus="PromptTemplateTextBox_LostFocus"/>
                                
                                <!-- Save Button -->
                                <Button x:Name="savePromptButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SavePrompt]}" Grid.Row="6" Grid.Column="1"
                                       HorizontalAlignment="Right" Margin="0,10,0,0" Padding="10,5"
                                       Click="SavePromptButton_Click"/>

                                <!-- Restore Default Prompt Button -->
                                <Button x:Name="restoreDefaultPromptButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_RestoreDefaultPrompt]}" Grid.Row="6" Grid.Column="1"
                                       HorizontalAlignment="Left" Margin="0,10,0,0" Padding="10,5"
                                       Click="RestoreDefaultPromptButton_Click"/>

                                <!-- Restore Default Prompt Button -->
                                <TextBlock x:Name="statusPrompt" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_PromptSaved]}" Grid.Row="6" Grid.Column="1" Visibility="Collapsed"
                                       HorizontalAlignment="Center" Margin="0,10,0,0" Padding="10,5"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Text-to-Speech Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_TTS]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Text-to-Speech Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_TTSSettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/> <!-- Row 0: Enable TTS -->
                                    <RowDefinition Height="Auto"/> <!-- Row 1: TTS Service -->
                                    <RowDefinition Height="Auto"/> <!-- Row 2: API Key -->
                                    <RowDefinition Height="Auto"/> <!-- Row 3: Voice dropdown -->
                                    <RowDefinition Height="Auto"/> <!-- Row 4: Custom Voice ID -->
                                    <RowDefinition Height="Auto"/> <!-- Row 5: Model -->
                                    <RowDefinition Height="Auto"/> <!-- Row 6: spacer -->
                                    <RowDefinition Height="Auto"/> <!-- Row 7: Exclude Character Name -->
                                </Grid.RowDefinitions>

                                <!-- TTS Enabled -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_EnableTTS]}" Grid.Row="0" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="ttsEnabledCheckBox" Grid.Row="0" Grid.Column="1" 
                                         Margin="0,5"
                                         Checked="TtsEnabledCheckBox_CheckedChanged" 
                                         Unchecked="TtsEnabledCheckBox_CheckedChanged"/>
                                
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ExcludeCharName]}" Grid.Row="7" Grid.Column="0"
                                          ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_ExcludeCharName]}"
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="excludeCharacterNameCheckBox" Grid.Row="7" Grid.Column="1"
                                         Margin="0,5"
                                         Checked="ExcludeCharacterNameCheckBox_CheckedChanged"
                                         Unchecked="ExcludeCharacterNameCheckBox_CheckedChanged"/>
                                
                                <!-- TTS Service -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_TTSService]}" Grid.Row="1" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="ttsServiceComboBox" Grid.Row="1" Grid.Column="1" 
                                         Margin="0,5" SelectedIndex="0" SelectionChanged="TtsServiceComboBox_SelectionChanged">
                                    <ComboBoxItem Content="ElevenLabs"/>
                                    <ComboBoxItem Content="Google Cloud TTS"/>
                                    <ComboBoxItem Content="Windows TTS"/>
                                </ComboBox>
                                
                                <!-- ElevenLabs API Key - Only visible when ElevenLabs is selected -->
                                <TextBlock x:Name="elevenLabsApiKeyLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ElevenLabsKey]}" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Margin="0,5,0,0" x:Name="elevenLabsApiKeyGrid">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="elevenLabsApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="ElevenLabsApiKeyPasswordBox_PasswordChanged"/>
                                    <TextBlock Grid.Row="1" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11" x:Name="elevenLabsApiKeyHelpText">
                                        <Run>Get API key from </Run>
                                        <Hyperlink Click="ElevenLabsApiLink_Click">https://elevenlabs.io/app/api-key</Hyperlink>
                                        <Run> (free tier available)</Run>
                                    </TextBlock>
                                </Grid>
                                
                                <!-- ElevenLabs Voice - Only visible when ElevenLabs is selected -->
                                <TextBlock x:Name="elevenLabsVoiceLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ElevenLabsVoice]}" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0"/>
                                <ComboBox x:Name="elevenLabsVoiceComboBox" Grid.Row="3" Grid.Column="1"
                                         Margin="0,5" SelectionChanged="ElevenLabsVoiceComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Rachel" Tag="21m00Tcm4TlvDq8ikWAM"/>
                                    <ComboBoxItem Content="Domi" Tag="AZnzlk1XvdvUeBnXmlld"/>
                                    <ComboBoxItem Content="Bella" Tag="EXAVITQu4vr4xnSDxMaL"/>
                                    <ComboBoxItem Content="Antoni" Tag="ErXwobaYiN019PkySvjV"/>
                                    <ComboBoxItem Content="Elli" Tag="MF3mGyEYCl7XYWbV9V6O"/>
                                    <ComboBoxItem Content="Josh" Tag="TxGEqnHWrfWFTfGW9XjX"/>
                                    <ComboBoxItem Content="Arnold" Tag="VR6AewLTigWG4xSOukaG"/>
                                    <ComboBoxItem Content="Adam" Tag="pNInz6obpgDQGcFmaJgB"/>
                                    <ComboBoxItem Content="Sam" Tag="yoZ06aMxZJJ28mfd3POQ"/>
                                    <ComboBoxItem Content="MC Anh Äá»©c" Tag="XBDAUT8ybuJTTCoOLSUj"/>
                                    <ComboBoxItem Content="Mc HÃ  My - Vietnames - calm and kind" Tag="RmcV9cAq1TByxNSgbii7"/>
                                    <ComboBoxItem Content="Custom Voice ID..." Tag="custom"/>
                                </ComboBox>

                                <!-- Custom Voice ID - Only visible when Custom is selected -->
                                <TextBlock x:Name="elevenLabsCustomVoiceLabel" Text="Custom Voice ID:" Grid.Row="4" Grid.Column="0"
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"/>
                                <TextBox x:Name="elevenLabsCustomVoiceTextBox" Grid.Row="4" Grid.Column="1"
                                         Margin="0,5" Visibility="Collapsed" TextChanged="ElevenLabsCustomVoiceTextBox_TextChanged"/>

                                <!-- ElevenLabs Model - Only visible when ElevenLabs is selected -->
                                <TextBlock x:Name="elevenLabsModelLabel" Text="Model:" Grid.Row="5" Grid.Column="0"
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"/>
                                <ComboBox x:Name="elevenLabsModelComboBox" Grid.Row="5" Grid.Column="1"
                                         Margin="0,5" Visibility="Collapsed" SelectionChanged="ElevenLabsModelComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Flash v2.5 (Fastest, 50% off)" Tag="eleven_flash_v2_5"/>
                                    <ComboBoxItem Content="Turbo v2.5 (Balanced, 50% off)" Tag="eleven_turbo_v2_5"/>
                                    <ComboBoxItem Content="Multilingual v2 (High quality)" Tag="eleven_multilingual_v2"/>
                                    <ComboBoxItem Content="Eleven v3 (Best, alpha)" Tag="eleven_v3"/>
                                </ComboBox>

                                <!-- Windows TTS Voice - Only visible when Windows TTS is selected -->
                                <TextBlock x:Name="windowTTSVoiceLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_WindowsTTSVoice]}" Grid.Row="2" Grid.Column="0" 
                                        VerticalAlignment="Center" Margin="0,5,10,0"/>
                                <ComboBox x:Name="windowTTSVoiceComboBox" Grid.Row="2" Grid.Column="1" 
                                        Margin="0,5" SelectionChanged="WindowTTSVoiceComboBox_SelectionChanged">
                                    <ComboBoxItem Content="Microsoft An (vi-VN, Male)"/>
                                    <ComboBoxItem Content="Microsoft David (en-US, Male)"/>
                                </ComboBox>

                                <!-- Windows TTS Guide GroupBox -->
                                <GroupBox x:Name="windowsTTSGuide" Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_WindowsTTSGuide]}" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,10,0,0" Visibility="Collapsed">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_RoboticVoices]}" Grid.Row="0" Grid.Column="0" 
                                                VerticalAlignment="Top" Margin="0,5,10,0" FontWeight="Bold"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" 
                                                VerticalAlignment="Top" Margin="0,5,0,0" TextWrapping="Wrap"
                                                Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_RoboticVoicesGuide]}"/>
                                        
                                        <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_NaturalVoices]}" Grid.Row="1" Grid.Column="0" 
                                                VerticalAlignment="Top" Margin="0,10,10,0" FontWeight="Bold"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" 
                                                VerticalAlignment="Top" Margin="0,10,0,0" TextWrapping="Wrap"
                                                Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_NaturalVoicesIntro]}"/>
                                        
                                        <TextBlock Grid.Row="2" Grid.Column="1" VerticalAlignment="Top" Margin="0,5,0,0" TextWrapping="Wrap">
                                            <Run Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_NaturalVoicesStep1], Mode=OneWay}"/>
                                            <Hyperlink Click="NaturalVoiceSAPIAdapterLink_Click">https://github.com/gexgd0419/NaturalVoiceSAPIAdapter</Hyperlink>
                                        </TextBlock>
                                        
                                        <TextBlock Grid.Row="3" Grid.Column="1" 
                                                VerticalAlignment="Top" Margin="0,5,0,0" TextWrapping="Wrap" 
                                                Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_NaturalVoicesStep2]}"/>
                                        
                                        <TextBlock Grid.Row="4" Grid.Column="1" 
                                                VerticalAlignment="Top" Margin="0,5,0,10" TextWrapping="Wrap" 
                                                Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_NaturalVoicesStep3]}"/>

                                        <TextBlock Grid.Row="5" Grid.Column="1" 
                                                VerticalAlignment="Top" Margin="0,5,0,10" TextWrapping="Wrap" 
                                                Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_NaturalVoicesStep4]}"/>
                                    </Grid>
                                </GroupBox>
                                
                                <!-- Google TTS API Key - Only visible when Google TTS is selected -->
                                <TextBlock x:Name="googleTtsApiKeyLabel" Text="Google API Key:" Grid.Row="2" Grid.Column="0" 
                                          VerticalAlignment="Top" Margin="0,8,10,0" Visibility="Collapsed"/>
                                <Grid Grid.Row="2" Grid.Column="1" Visibility="Collapsed" x:Name="googleTtsApiKeyGrid" Margin="0,5,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <PasswordBox x:Name="googleTtsApiKeyPasswordBox" Grid.Row="0"
                                             VerticalAlignment="Top" Margin="0,0,0,2" 
                                             PasswordChanged="GoogleTtsApiKeyPasswordBox_PasswordChanged"/>
                                    <TextBlock Grid.Row="1" TextWrapping="Wrap" Margin="0,2,0,5" FontSize="11">
                                        <Run>Get API key from </Run>
                                        <Hyperlink Click="GoogleTtsApiLink_Click">https://cloud.google.com/text-to-speech</Hyperlink>
                                        <Run> (free tier: 4M chars/month)</Run>
                                    </TextBlock>
                                </Grid>
                                
                                <!-- Google TTS Voice - Only visible when Google TTS is selected -->
                                <TextBlock x:Name="googleTtsVoiceLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_GoogleTTSVoice]}" Grid.Row="3" Grid.Column="0" 
                                          VerticalAlignment="Center" Margin="0,5,10,0" Visibility="Collapsed"/>
                                <ComboBox x:Name="googleTtsVoiceComboBox" Grid.Row="3" Grid.Column="1" 
                                         Margin="0,5" SelectionChanged="GoogleTtsVoiceComboBox_SelectionChanged" Visibility="Collapsed">
                                    <!-- Japanese Voices -->
                                    <ComboBoxItem Content="Japanese (Female) - Neural2" Tag="ja-JP-Neural2-B"/>
                                    <ComboBoxItem Content="Japanese (Male) - Neural2" Tag="ja-JP-Neural2-C"/>
                                    <ComboBoxItem Content="Japanese (Male Deep) - Neural2" Tag="ja-JP-Neural2-D"/>
                                    
                                    <!-- English Voices -->
                                    <ComboBoxItem Content="English US (Female) - Studio" Tag="en-US-Studio-O"/>
                                    <ComboBoxItem Content="English US (Male) - Studio" Tag="en-US-Studio-M"/>
                                    <ComboBoxItem Content="English UK (Female) - Neural2" Tag="en-GB-Neural2-F"/>
                                    
                                    <!-- French Voices -->
                                    <ComboBoxItem Content="French (Female) - Neural2" Tag="fr-FR-Neural2-A"/>
                                    <ComboBoxItem Content="French (Male) - Neural2" Tag="fr-FR-Neural2-D"/>
                                    
                                    <!-- German Voices -->
                                    <ComboBoxItem Content="German (Female) - Neural2" Tag="de-DE-Neural2-F"/>
                                    <ComboBoxItem Content="German (Male) - Neural2" Tag="de-DE-Neural2-B"/>
                                    
                                    <!-- Spanish Voices -->
                                    <ComboBoxItem Content="Spanish (Female) - Neural2" Tag="es-ES-Neural2-F"/>
                                    <ComboBoxItem Content="Spanish (Male) - Neural2" Tag="es-ES-Neural2-C"/>
                                    
                                    <!-- Korean Voices -->
                                    <ComboBoxItem Content="Korean (Female) - Neural2" Tag="ko-KR-Neural2-A"/>
                                    <ComboBoxItem Content="Korean (Male) - Neural2" Tag="ko-KR-Neural2-C"/>
                                    
                                    <!-- Chinese Voices -->
                                    <ComboBoxItem Content="Chinese (Female) - Neural2" Tag="cmn-CN-Neural2-A"/>
                                    <ComboBoxItem Content="Chinese (Male) - Neural2" Tag="cmn-CN-Neural2-C"/>
                                    
                                    <!-- Vietnamese Voices -->
                                    <ComboBoxItem Content="Vietnamese (Female) - Neural2" Tag="vi-VN-Neural2-A"/>
                                    <ComboBoxItem Content="Vietnamese (Male) - Neural2" Tag="vi-VN-Neural2-D"/>
                                </ComboBox>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Hot Keys Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_HotKeys]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Hot Keys Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_HotKeySettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_HotKeyEnable]}" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="hotKeyEnableCheckBox" Checked="SetHotKeyEnableCheckBox_CheckChange" ToolTip="Enable/Disable hotkeys"
                                    Unchecked="SetHotKeyEnableCheckBox_CheckChange" Grid.Row="0" Grid.Column="1" Padding="5,3" Margin="0,8,10,10"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_HotKeyFunctions]}" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="hotKeyFunctionComboBox" Grid.Row="1" Grid.Column="1" Padding="5,3" Margin="0,8,10,10" SelectionChanged="HotKeyFunctionComboBox_SelectionChanged">
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Select]}" Tag=""/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_StartStop]}" Tag="Start/Stop"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Overlay]}" Tag="Overlay"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Setting]}" Tag="Setting"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Log]}" Tag="Log"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_SelectArea]}" Tag="Select Area"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_ClearAreas]}" Tag="Clear Areas"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_ClearSelectedArea]}" Tag="Clear Selected Area"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_ShowArea]}" Tag="Show Area"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_ChatBox]}" Tag="ChatBox"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Area1]}" Tag="Area 1"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Area2]}" Tag="Area 2"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Area3]}" Tag="Area 3"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Area4]}" Tag="Area 4"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Area5]}" Tag="Area 5"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_AudioService]}" Tag="Audio Service"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_SwapLanguages]}" Tag="Swap Languages"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_TranslationRetry]}" Tag="Retry Translation"/>
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectExcludeRegion]}" Tag="Select Exclude Region"/>
                                </ComboBox>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_CombineKeys]}" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="combineKey1" Grid.Row="2" Grid.Column="1" Padding="5,3" Margin="0,8,10,10">
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Select]}"/>
                                    <ComboBoxItem Content="CTRL"/>
                                    <ComboBoxItem Content="SHIFT"/>
                                    <ComboBoxItem Content="ALT"/>
                                </ComboBox>
                                <ComboBox x:Name="combineKey2" Grid.Row="2" Grid.Column="2" Padding="5,3" Margin="0,8,10,10">
                                    <ComboBoxItem Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Cmb_Select]}"/>
                                    <ComboBoxItem Content="A"/>
                                    <ComboBoxItem Content="B"/>
                                    <ComboBoxItem Content="C"/>
                                    <ComboBoxItem Content="D"/>
                                    <ComboBoxItem Content="E"/>
                                    <ComboBoxItem Content="F"/>
                                    <ComboBoxItem Content="G"/>
                                    <ComboBoxItem Content="H"/>
                                    <ComboBoxItem Content="J"/>
                                    <ComboBoxItem Content="K"/>
                                    <ComboBoxItem Content="L"/>
                                    <ComboBoxItem Content="M"/>
                                    <ComboBoxItem Content="N"/>
                                    <ComboBoxItem Content="O"/>
                                    <ComboBoxItem Content="V"/>
                                    <ComboBoxItem Content="X"/>
                                    <ComboBoxItem Content="Z"/>
                                    <ComboBoxItem Content="Q"/>
                                    <ComboBoxItem Content="W"/>
                                    <ComboBoxItem Content="R"/>
                                    <ComboBoxItem Content="T"/>
                                    <ComboBoxItem Content="Y"/>
                                    <ComboBoxItem Content="U"/>
                                    <ComboBoxItem Content="I"/>
                                    <ComboBoxItem Content="P"/>
                                    <ComboBoxItem Content="0"/>
                                    <ComboBoxItem Content="1"/>
                                    <ComboBoxItem Content="2"/>
                                    <ComboBoxItem Content="3"/>
                                    <ComboBoxItem Content="4"/>
                                    <ComboBoxItem Content="5"/>
                                    <ComboBoxItem Content="6"/>
                                    <ComboBoxItem Content="7"/>
                                    <ComboBoxItem Content="8"/>
                                    <ComboBoxItem Content="9"/>
                                </ComboBox>
                                <Button x:Name="setHotKeyButton" Content="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_SetHotKey]}"  Grid.Row="3" Grid.Column="1"
                                       HorizontalAlignment="Center" Width="100" Margin="0,8,0,10" Padding="5,3" Click="SetHotKeyButton_Click"
                                       ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_SetHotKey]}"/>
                                <TextBlock x:Name="statusUpdateHotKey" Foreground="Green" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_HotKeyUpdateSuccess]}" 
                                    Visibility="Collapsed" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <!-- List HotKey Table -->
                                <Border Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,10,0,0" BorderBrush="#333" BorderThickness="1" CornerRadius="5">
                                    <StackPanel>
                                        <Border Background="#333" Padding="10,5">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_FunctionName]}" FontWeight="Bold" Foreground="White"/>
                                                <TextBlock Grid.Column="1" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_Shortcut]}" FontWeight="Bold" Foreground="White" Margin="0,0,20,0"/>
                                            </Grid>
                                        </Border>
                                        
                                        <!-- Items -->
                                        <ScrollViewer MaxHeight="300" VerticalScrollBarVisibility="Auto">
                                            <StackPanel>
                                                <!-- Item Template -->
                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_StartStopTranslation]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyStartStop" Text="ALT + G" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ToggleOverlay]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyOverlay" Text="ALT + F" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>
                                                
                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_OpenSettings]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeySetting" Text="ALT + P" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ToggleLog]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyLog" Text="ALT + L" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectArea]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeySelectArea" Text="ALT + Q" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ClearAllAreas]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyClearAreas" Text="ALT + R" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ClearSelectedArea]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyClearPreviousArea" Text="ALT + H" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ShowAreaBorder]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyShowArea" Text="ALT + B" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ToggleChatBox]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyChatBox" Text="ALT + C" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>
                                                
                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_AudioService]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyAudio" Text="ALT + K" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <!-- Areas 1-5 -->
                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectArea1]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyArea1" Text="ALT + 1" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>
                                                
                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectArea2]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyArea2" Text="ALT + 2" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectArea3]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyArea3" Text="ALT + 3" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectArea4]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyArea4" Text="ALT + 4" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectArea5]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyArea5" Text="ALT + 5" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SwapLanguages]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeySwapLanguages" Text="ALT + V" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_TranslationRetry]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyRetryTranslate" Text="ALT + T" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                                <Separator Background="#222" Margin="5,2"/>

                                                <Grid Margin="10,5">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectExcludeRegion]}"/>
                                                    <TextBlock Grid.Column="1" x:Name="hotKeyToggleExcludeRegions" Text="ALT + X" FontWeight="Bold" Foreground="#3498db"/>
                                                </Grid>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Audio Processing Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_Audio]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Audio Processing Settings -->
                       <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_AudioProcessingSettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_AudioAutoTranslation]}" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0" Visibility="Collapsed"/>
                                <CheckBox x:Name="audioServiceAutoTranslateCheckBox" Grid.Row="0" Grid.Column="1" Margin="0,5" Visibility="Collapsed"
                                         Checked="AudioServiceAutoTranslateCheckBox_CheckedChanged"
                                         Unchecked="AudioServiceAutoTranslateCheckBox_CheckedChanged"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_Provider]}" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="audioProcessingProviderComboBox" Grid.Row="1" Grid.Column="1" Margin="0,5" SelectionChanged="AudioProcessingProviderComboBox_SelectionChanged">
                                    <ComboBoxItem Content="WhisperX"/>
                                </ComboBox>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_Model]}" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="audioProcessingModelComboBox" Grid.Row="2" Grid.Column="1" Margin="0,5" SelectionChanged="AudioProcessingModelComboBox_SelectionChanged">
                                    <ComboBoxItem Content="ggml-tiny"/>
                                </ComboBox>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_WhisperRuntime]}" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="whisperRuntimeComboBox" Grid.Row="3" Grid.Column="1" Margin="0,5" SelectionChanged="WhisperRuntimeComboBox_SelectionChanged">
                                    <ComboBoxItem Content="CPU" Tag="cpu"/>
                                    <ComboBoxItem Content="CUDA (NVIDIA GPU)" Tag="cuda"/>
                                    <ComboBoxItem Content="Vulkan (GPU)" Tag="vulkan"/>
                                </ComboBox>
                                <TextBlock Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" 
                                        Margin="0,0,0,5" 
                                        FontStyle="Italic" 
                                        FontSize="11" 
                                        Foreground="Gray"
                                        TextWrapping="Wrap"
                                        Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_WhisperRuntime]}"/>
                                <TextBlock x:Name="audioModelDownloadTextBlock"
                                        Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="2" 
                                        Margin="0,0,0,0" 
                                        FontStyle="Italic" 
                                        FontSize="11" 
                                        Foreground="Red"
                                        TextWrapping="Wrap"
                                        Loaded="AudioModelDownloadTextBlock_Loaded"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_VolumeThreshold]}" Grid.Row="6" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="silenceThresholdTextBox" Grid.Row="6" Grid.Column="1" Margin="0,5" Text="0.01" LostFocus="SilenceThresholdTextBox_LostFocus"/>
                                <TextBlock Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="2" 
                                        Margin="0,0,0,0" 
                                        FontStyle="Italic" 
                                        FontSize="11" 
                                        Foreground="Red"
                                        TextWrapping="Wrap"
                                        Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_VolumeThreshold]}"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SilenceDuration]}" Grid.Row="8" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="silenceDurationTextBox" Grid.Row="8" Grid.Column="1" Margin="0,5" Text="500" LostFocus="SilenceDurationTextBox_LostFocus"/>
                                <TextBlock Grid.Row="9" Grid.Column="1" Grid.ColumnSpan="2" 
                                        Margin="0,0,0,0" 
                                        FontStyle="Italic" 
                                        FontSize="11" 
                                        Foreground="Red"
                                        TextWrapping="Wrap"
                                        Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_SilenceDuration]}"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_MaxBufferSamples]}" Grid.Row="10" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="maxBufferSamplesTextBox" Grid.Row="10" Grid.Column="1" Margin="0,5" Text="5" LostFocus="MaxBufferSamplesTextBox_LostFocus"/>
                                <TextBlock Grid.Row="11" Grid.Column="1" Grid.ColumnSpan="2" 
                                        Margin="0,0,0,0" 
                                        FontStyle="Italic" 
                                        FontSize="11" 
                                        Foreground="Red"
                                        TextWrapping="Wrap"
                                        Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_MaxBufferSamples]}"/>
                                <TextBlock x:Name="whisperThreadCountLabel" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_WhisperThreadCount]}" Grid.Row="12" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="whisperThreadCountTextBox" Grid.Row="12" Grid.Column="1" Margin="0,5" Text="0" LostFocus="WhisperThreadCountTextBox_LostFocus"/>
                                <TextBlock x:Name="whisperThreadCountTip" Grid.Row="13" Grid.Column="1" Grid.ColumnSpan="2" 
                                        Margin="0,0,0,0" 
                                        FontStyle="Italic" 
                                        FontSize="11" 
                                        Foreground="Red"
                                        TextWrapping="Wrap"
                                        Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_WhisperThreadCount]}"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Clipboard Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_Clipboard]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Clipboard Auto-Translate Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ClipboardAutoTranslate]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Enable Clipboard Auto-Translate -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_EnableClipboardTranslate]}" 
                                           Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="clipboardAutoTranslateCheckBox" Grid.Row="0" Grid.Column="1" Margin="0,5"
                                         Checked="ClipboardAutoTranslateCheckBox_CheckedChanged"
                                         Unchecked="ClipboardAutoTranslateCheckBox_CheckedChanged"
                                         ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_ClipboardEnable]}"/>
                                
                                <!-- Copy Result to Clipboard -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ClipboardCopyResult]}" 
                                           Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <CheckBox x:Name="clipboardCopyResultCheckBox" Grid.Row="1" Grid.Column="1" Margin="0,5"
                                         Checked="ClipboardCopyResultCheckBox_CheckedChanged"
                                         Unchecked="ClipboardCopyResultCheckBox_CheckedChanged"
                                         ToolTip="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_ClipboardCopyResult]}"/>
                                
                                <!-- Debounce Time -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ClipboardDebounce]}" 
                                           Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="clipboardDebounceTextBox" Grid.Row="2" Grid.Column="1" Margin="0,5" Text="300" 
                                         LostFocus="ClipboardDebounceTextBox_LostFocus"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" 
                                           Margin="0,0,0,5" 
                                           FontStyle="Italic" 
                                           FontSize="11" 
                                           Foreground="Gray"
                                           TextWrapping="Wrap"
                                           Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_ClipboardDebounce]}"/>
                                
                                <!-- Max Characters -->
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ClipboardMaxChars]}" 
                                           Grid.Row="4" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="clipboardMaxCharsTextBox" Grid.Row="4" Grid.Column="1" Margin="0,5" Text="5000" 
                                         LostFocus="ClipboardMaxCharsTextBox_LostFocus"/>
                                <TextBlock Grid.Row="5" Grid.Column="1" 
                                           Margin="0,0,0,5" 
                                           FontStyle="Italic" 
                                           FontSize="11" 
                                           Foreground="Gray"
                                           TextWrapping="Wrap"
                                           Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tip_ClipboardMaxChars]}"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Server Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_Server]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Server Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ServerSetting]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_InstallServer]}" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <Button Grid.Row="0" Grid.Column="1" Click="InstallServerButton_Click" HorizontalAlignment="Left"
                                        Width="100" Height="20" Margin="50,10,10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_Install]}"/>
                                </Button>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_RemoveServer]}" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <Button Grid.Row="1" Grid.Column="1" Click="RemoveServerButton_Click" HorizontalAlignment="Left"
                                        Width="100" Height="20" Margin="50,10,10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_Remove]}"/>
                                </Button>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_StartServer]}" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <Button Grid.Row="2" Grid.Column="1" Click="StartServerButton_Click" HorizontalAlignment="Left"
                                        Width="100" Height="20" Margin="50,10,10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_Start]}"/>
                                </Button>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SendData]}" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Margin="0,10,10,0"/>
                                <CheckBox x:Name="isSendDataToServerCheckBox" Grid.Row="3" Grid.Column="1" Margin="50,10,10,0"
                                         Checked="IsSendDataToServerCheckBox_CheckedChanged"
                                         Unchecked="IsSendDataToServerCheckBox_CheckedChanged"/>
                            </Grid>
                        </GroupBox>
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ServerGuide]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_ServerGuide1]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap"
                                    Grid.Row="1" Grid.Column="1" Margin="10,10,0,0"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_ServerGuide2]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap"
                                    Grid.Row="2" Grid.Column="1" Margin="10,10,0,0"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!--  Game Profile Tab -->
            <TabItem Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Tab_GameProfile]}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <!-- Audio Processing Settings -->
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ProfileSettings]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_ProfileName]}" Grid.Row="0" Grid.Column="0" 
                                          Margin="0,10,10,0"/>
                                <TextBox x:Name="profileNameTextBox" Grid.Row="0" Grid.Column="1" 
                                          Margin="0,5"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_SelectProfile]}" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <ComboBox x:Name="profileComboBox" Grid.Row="1" Grid.Column="1" Margin="0,5">
                                </ComboBox>
                                <Button Grid.Row="0" Grid.Column="2" Click="CreateProfileButton_Click"
                                        Width="100" Height="20" Margin="10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_CreateProfile]}"/>
                                </Button>
                                <Button Grid.Row="2" Grid.Column="1" Click="UpdateProfileButton_Click"
                                        Width="100" Height="20" Margin="10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_UpdateProfile]}"/>
                                </Button>
                                <Button Grid.Row="1" Grid.Column="2" Click="RemoveProfileButton_Click"
                                        Width="100" Height="20" Margin="10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_RemoveProfile]}"/>
                                </Button>
                                <Button Grid.Row="2" Grid.Column="2" Click="LoadProfileButton_Click"
                                        Width="100" Height="20" Margin="10,0">
                                    <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Btn_LoadProfile]}"/>
                                </Button>
                                <TextBlock x:Name="statusUpdateGameProfile" Foreground="Green" Text="" HorizontalAlignment="Center"
                                    Grid.Row="3" Grid.Column="1" Margin="0,20,0,0"/>
                            </Grid>
                        </GroupBox>
                        <GroupBox Header="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Grp_ProfileDetails]}" Margin="0,0,0,15" Padding="10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock FontWeight="Bold" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_CreateProfileBold]}" HorizontalAlignment="Left"
                                    Grid.Row="0" Grid.Column="0" Margin="0,10,0,0"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_CreateProfileGuide]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap"
                                    Grid.Row="0" Grid.Column="1" Margin="10,10,0,0"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_ProfileNameNote]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap" Foreground="Red"
                                    Grid.Row="1" Grid.Column="1" Margin="10,10,0,0"/>
                                <TextBlock FontWeight="Bold" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_RemoveProfileBold]}" HorizontalAlignment="Left"
                                    Grid.Row="2" Grid.Column="0" Margin="0,10,0,0"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_RemoveProfileGuide]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap"
                                    Grid.Row="2" Grid.Column="1" Margin="10,10,0,0"/>
                                <TextBlock FontWeight="Bold" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_UpdateProfileBold]}" HorizontalAlignment="Left"
                                    Grid.Row="3" Grid.Column="0" Margin="0,10,0,0"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_UpdateProfileGuide]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap"
                                    Grid.Row="3" Grid.Column="1" Margin="10,10,0,0"/>
                                <TextBlock FontWeight="Bold" Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Lbl_LoadProfileBold]}" HorizontalAlignment="Left"
                                    Grid.Row="4" Grid.Column="0" Margin="0,10,0,0"/>
                                <TextBlock Text="{Binding Source={x:Static local:LocalizationManager.Instance}, Path=Strings[Msg_LoadProfileGuide]}" 
                                    HorizontalAlignment="Left" TextWrapping="Wrap"
                                    Grid.Row="4" Grid.Column="1" Margin="10,10,0,0"/>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</Window>