<Window x:Class="RSTGameTranslation.QuickstartWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:RSTGameTranslation"
        mc:Ignorable="d"
        Title="RST Game Translation - Quick Start Guide" 
        Height="600" Width="800"
        Background="#1E1E1E"
        Foreground="White"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with progress indicator -->
        <Grid Grid.Row="0" Margin="20,15,20,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Text="Quick Start Guide" FontSize="18" FontWeight="Bold" VerticalAlignment="Center" Foreground="#3498db"/>

            <!-- Step indicators -->
            <Border Grid.Column="1" x:Name="Step1Indicator" Width="20" Height="20" CornerRadius="10" Background="#646464" Margin="0,0,5,0">
                <TextBlock Text="1" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="12" FontWeight="Bold" Foreground="White"/>
            </Border>
            <Border Grid.Column="2" x:Name="Step2Indicator" Width="20" Height="20" CornerRadius="10" Background="#646464" Margin="0,0,5,0">
                <TextBlock Text="2" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="12" FontWeight="Bold" Foreground="White"/>
            </Border>
            <Border Grid.Column="3" x:Name="Step3Indicator" Width="20" CornerRadius="10" Background="#646464" Margin="5,2,5,0" Height="20" VerticalAlignment="Top">
                <TextBlock Text="3" HorizontalAlignment="Center" VerticalAlignment="Top" FontSize="12" FontWeight="Bold" Foreground="White" Margin="0,2,0,0"/>
            </Border>
            <Border Grid.Column="4" x:Name="Step4Indicator" Width="20" Height="20" CornerRadius="10" Background="#646464" Margin="5,0">
                <TextBlock Text="4" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="12" FontWeight="Bold" Foreground="White"/>
            </Border>
            <Border Grid.Column="5" x:Name="Step5Indicator" Width="20" Height="20" CornerRadius="10" Background="#646464" Margin="5,0,0,0">
                <TextBlock Text="5" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="12" FontWeight="Bold" Foreground="White"/>
            </Border>

            <Button Grid.Column="6" Content="Skip" HorizontalAlignment="Right" Padding="10,3" Click="SkipButton_Click"/>
        </Grid>

        <Rectangle Grid.Row="0" Height="1" Fill="#333333" VerticalAlignment="Bottom"/>

        <!-- Content area -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid Margin="20">
                <!-- Welcome Panel -->
                <StackPanel x:Name="WelcomePanel" Visibility="Visible">
                    <TextBlock TextWrapping="Wrap" FontSize="20" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,20">
                        Welcome to RSTGameTranslation!
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        This quick start guide will help you set up the essential features to start translating games.
                    </TextBlock>

                    <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock FontWeight="Bold" FontSize="16" Foreground="#3498db" Margin="0,0,0,10">How RST Game Translation Works:</TextBlock>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="1." FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="Select an area on your screen containing text to translate" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="2." FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="OCR technology recognizes the text in the selected area" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="3." FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="The text is translated using your selected translation service" TextWrapping="Wrap" Margin="0,0,0,10"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="4." FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="The translated text is displayed on your screen (overlay) or on chatbox" TextWrapping="Wrap"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,10">
                        This guide will help you configure:
                    </TextBlock>

                    <StackPanel Margin="20,0,0,0">
                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                            • Language settings for source and target languages
                        </TextBlock>
                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                            • OCR method for text recognition
                        </TextBlock>
                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                            • Translation service selection
                        </TextBlock>
                    </StackPanel>
                </StackPanel>

                <!-- Language Settings Panel -->
                <StackPanel x:Name="LanguagePanel" Visibility="Collapsed">
                    <TextBlock TextWrapping="Wrap" FontSize="20" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,20">
                        Language Settings
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Select the source language (the language in your game) and the target language (the language you want to translate to).
                    </TextBlock>

                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Source Language -->
                        <StackPanel Grid.Column="0" Grid.Row="0">
                            <TextBlock Text="Source Language:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ComboBox x:Name="SourceLanguageComboBox" Width="200" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Target Language -->
                        <StackPanel Grid.Column="2" Grid.Row="0">
                            <TextBlock Text="Target Language:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ComboBox x:Name="TargetLanguageComboBox" Width="200" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Grid>

                    <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock FontWeight="Bold" FontSize="16" Foreground="#3498db" Margin="0,0,0,10">Common Language Pairs:</TextBlock>
                            <WrapPanel>
                                <Button Content="Japanese → English" Margin="5" Padding="8,3" Click="CommonPair_Click" Tag="ja,en"/>
                                <Button Content="Japanese → Vietnamese" Margin="5" Padding="8,3" Click="CommonPair_Click" Tag="ja,vi"/>
                                <Button Content="Korean → English" Margin="5" Padding="8,3" Click="CommonPair_Click" Tag="ko,en"/>
                                <Button Content="Korean → Vietnamese" Margin="5" Padding="8,3" Click="CommonPair_Click" Tag="ko,vi"/>
                                <Button Content="Chinese → English" Margin="5" Padding="8,3" Click="CommonPair_Click" Tag="ch_sim,en"/>
                                <Button Content="Chinese → Vietnamese" Margin="5" Padding="8,3" Click="CommonPair_Click" Tag="ch_sim,vi"/>
                            </WrapPanel>
                        </StackPanel>
                    </Border>

                    <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray">
                        Note: You can change these settings later in the Settings menu -> Language tab
                    </TextBlock>
                    <GroupBox Header="Language Mapping" Margin="0,0,0,15" Padding="10">
                            <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" 
                                    Margin="0,15,0,0" TextWrapping="Wrap" FontSize="12">
                                <Run>ja = Japanese</Run>
                                <LineBreak/>
                                <Run>en = English</Run>
                                <LineBreak/>
                                <Run>ch_sim = Chinese (Simplified)</Run>
                                <LineBreak/>
                                <Run>ko = Korean</Run>
                                <LineBreak/>
                                <Run>vi = Vietnamese</Run>
                                <LineBreak/>
                                <Run>fr = French</Run>
                                <LineBreak/>
                                <Run>ru = Russian</Run>
                                <LineBreak/>
                                <Run>de = German</Run>
                                <LineBreak/>
                                <Run>es = Spanish</Run>
                                <LineBreak/>
                                <Run>it = Italian</Run>
                                <LineBreak/>
                                <Run>hi = Hindi</Run>
                                <LineBreak/>
                                <Run>tr = Turkish</Run>
                            </TextBlock>
                            <TextBlock Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="3" 
                                Margin="0,15,0,0" TextWrapping="Wrap" FontSize="12">
                                <Run>pt = Portuguese</Run>
                                <LineBreak/>
                                <Run>ar = Arabic</Run>
                                <LineBreak/>
                                <Run>nl = Dutch</Run>
                                <LineBreak/>
                                <Run>pl = Polish</Run>
                                <LineBreak/>
                                <Run>ro = Romanian</Run>
                                <LineBreak/>
                                <Run>fa = Farsi</Run>
                                <LineBreak/>
                                <Run>cs = Czech</Run>
                                <LineBreak/>
                                <Run>id = Indonesian</Run>
                                <LineBreak/>
                                <Run>th = ThaiLand</Run>
                                <LineBreak/>
                                <Run>ch_tra = Traditional Chinese</Run>
                            </TextBlock>
                            </Grid>
                        </GroupBox>
                </StackPanel>

                <!-- Conda install Panel -->
                <StackPanel x:Name="CondaSetupPanel" Visibility="Collapsed">
                    <TextBlock TextWrapping="Wrap" FontSize="20" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,20">
                        Conda Setup:
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Conda is an environment that helps install and run OCR without affecting your computer is existing environment.
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Before installing Conda, make sure the current application directory path does not contain spaces or Unicode characters.
                    </TextBlock>
                    <Button Content="Setup Conda" Margin="0,10,0,0" Padding="8,3" Click="SetupConda_Click"/>
                </StackPanel>

                <!-- OCR Settings Panel -->
                <StackPanel x:Name="OcrPanel" Visibility="Collapsed">
                    <TextBlock TextWrapping="Wrap" FontSize="20" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,20">
                        OCR Method
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Select an OCR (Optical Character Recognition) method to recognize text in your games. 
                        (Setting > OCR tab)
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Note: If you haven't installed Conda yet, you need to install it (Step 2) before starting the steps below. 
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        For advanced OCR methods (EasyOCR, PaddleOCR, RapidOCR), you'll need to install and start the OCR server. 
                        This can be done through the SetupOCR button on the main screen or button Setup OCR server below after completing this guide.
                    </TextBlock>
                    <Grid Margin="0,0,0,20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="OCR Method:" FontWeight="Bold" Margin="0,5,10,0"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" x:Name="OcrMethodComboBox" Width="200" HorizontalAlignment="Left"/>
                        <Button x:Name="setupOCR" Grid.Row="0" Grid.Column="2" Content="Setup OCR Server" Margin="0,5,0,0" Click="SetupOcrServer_Click"/>
                    </Grid>

                    <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock FontWeight="Bold" FontSize="16" Foreground="#3498db" Margin="0,0,0,10">OCR Methods Comparison:</TextBlock>

                            <!-- Windows OCR -->
                            <Expander Header="Windows OCR (Recommended for beginners)" IsExpanded="True" Margin="0,0,0,10" Foreground="White">
                                <StackPanel Margin="10,5,0,0">
                                    <TextBlock TextWrapping="Wrap" Foreground="White">
                                        <Run FontWeight="Bold">Pros:</Run> Built-in, no additional setup required, works well for most Latin scripts
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Cons:</Run> May be less accurate for some Asian languages. Requires installing the corresponding language pack in Windows
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Recommendation:</Run> Best choice for beginners or if you don't have a dedicated GPU
                                    </TextBlock>
                                </StackPanel>
                            </Expander>

                            <!-- OneOCR -->
                            <Expander Header="OneOCR (Recommended for beginners)" IsExpanded="True" Margin="0,0,0,10" Foreground="White">
                                <StackPanel Margin="10,5,0,0">
                                    <TextBlock TextWrapping="Wrap" Foreground="White">
                                        <Run FontWeight="Bold">Pros:</Run> Built-in, no additional setup required, works well for most Language. Better Windows OCR
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Cons:</Run> May be less accurate for some Asian languages.
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Recommendation:</Run> Best choice for beginners or if you don't have a dedicated GPU
                                    </TextBlock>
                                </StackPanel>
                            </Expander>

                            <!-- RapidOCR -->
                            <Expander Header="RapidOCR" Margin="0,0,0,10" Foreground="White">
                                <StackPanel Margin="10,5,0,0">
                                    <TextBlock TextWrapping="Wrap" Foreground="White">
                                        <Run FontWeight="Bold">Pros:</Run> Good accuracy for Chinese, Japanese, and English language. It is inferior to PaddleOCR for other languages. Support all GPUs, including iGPU
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Cons:</Run> Requires additional setup, more resource-intensive, slower than Windows OCR without GPU. Consumes GPU resources (5-10%)
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Recommendation:</Run> AMD, INTEL or NVDIA
                                    </TextBlock>
                                </StackPanel>
                            </Expander>

                            <!-- EasyOCR -->
                            <Expander Header="EasyOCR" Margin="0,0,0,10" Foreground="White">
                                <StackPanel Margin="10,5,0,0">
                                    <TextBlock TextWrapping="Wrap" Foreground="White">
                                        <Run FontWeight="Bold">Pros:</Run> Good accuracy for many languages, supports GPU acceleration
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Cons:</Run> Requires additional setup, slower than Windows OCR without GPU. Consumes a lot of GPU resources (20-30%)
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Recommendation:</Run> NVIDIA RTX 4000 series and below
                                    </TextBlock>
                                </StackPanel>
                            </Expander>

                            <!-- PaddleOCR -->
                            <Expander Header="PaddleOCR" Margin="0,0,0,10" Foreground="White">
                                <StackPanel Margin="10,5,0,0">
                                    <TextBlock TextWrapping="Wrap" Foreground="White">
                                        <Run FontWeight="Bold">Pros:</Run> High accuracy with many languages
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Cons:</Run> Requires additional setup, more resource-intensive. Consumes a lot of GPU resources (5-15%)
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" Foreground="White">
                                        <Run FontWeight="Bold">Recommendation:</Run> NVIDIA RTX 2000 series and above
                                    </TextBlock>
                                </StackPanel>
                            </Expander>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Translation Service Panel -->
                <StackPanel x:Name="TranslationPanel" Visibility="Collapsed">
                    <TextBlock TextWrapping="Wrap" FontSize="20" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,20">
                        Translation Service
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Select a translation service to translate the recognized text.
                    </TextBlock>

                    <Grid Margin="0,0,0,20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Translation Service:" FontWeight="Bold" Margin="0,5,10,0"/>
                        <ComboBox Grid.Row="0" Grid.Column="1" x:Name="TranslationServiceComboBox" Width="200" HorizontalAlignment="Left" SelectionChanged="TranslationServiceComboBox_SelectionChanged"/>
                    </Grid>

                    <!-- Google Translate API Key -->
                    <StackPanel x:Name="GoogleTranslateApiKeyPanel" Visibility="Collapsed" Margin="0,0,0,10">
                        <TextBlock Text="Google Translate API Key (optional, After entering the API key, press Enter to save):" FontWeight="Bold" Margin="0,0,0,5"/>
                        <PasswordBox x:Name="GoogleTranslateApiKeyPasswordBox" Width="300" HorizontalAlignment="Left" KeyDown="GoogleTranslateApiKeyPasswordBox_PasswordChanged"/>
                        <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray" Margin="0,5,0,0">
                            Note: Google Translate works without an API key, but using one provides better service.
                        </TextBlock>
                    </StackPanel>

                    <!-- ChatGPT API Key -->
                    <StackPanel x:Name="ChatGptApiKeyPanel" Visibility="Collapsed" Margin="0,0,0,10">
                        <TextBlock Text="ChatGPT API Key (After entering the API key, press Enter to save):" FontWeight="Bold" Margin="0,0,0,5"/>
                        <PasswordBox x:Name="ChatGptApiKeyPasswordBox" Width="300" HorizontalAlignment="Left" KeyDown="ChatGptApiKeyPasswordBox_PasswordChanged"/>

                        <TextBlock Text="Model:" FontWeight="Bold" Margin="0,10,0,5"/>
                        <ComboBox x:Name="ChatGptModelComboBox" Width="300" HorizontalAlignment="Left"/>

                        <Button Content="Get API Key" HorizontalAlignment="Left" Margin="0,10,0,0" Padding="8,3" Click="GetApiKey_Click" Tag="https://platform.openai.com/api-keys"/>

                        <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray" Margin="0,5,0,0">
                            Note: ChatGPT provides high-quality translations but requires an API key with payment method.
                        </TextBlock>
                    </StackPanel>

                    <!-- Gemini API Key -->
                    <StackPanel x:Name="GeminiApiKeyPanel" Visibility="Collapsed" Margin="0,0,0,10">
                        <TextBlock Text="Gemini API Key (After entering the API key, press Enter to save):" FontWeight="Bold" Margin="0,0,0,5"/>
                        <PasswordBox x:Name="GeminiApiKeyPasswordBox" Width="300" HorizontalAlignment="Left" KeyDown="GeminiApiKeyPasswordBox_PasswordChanged"/>

                        <TextBlock Text="Model:" FontWeight="Bold" Margin="0,10,0,5"/>
                        <ComboBox x:Name="GeminiModelComboBox" Width="300" HorizontalAlignment="Left"/>

                        <Button Content="Get API Key" HorizontalAlignment="Left" Margin="0,10,0,0" Padding="8,3" Click="GetApiKey_Click" Tag="https://ai.google.dev/"/>

                        <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray" Margin="0,5,0,0">
                            Note: Gemini provides good translations with a free tier available.
                        </TextBlock>
                    </StackPanel>

                    <!-- Mistral API Key -->
                    <StackPanel x:Name="MistralApiKeyPanel" Visibility="Collapsed" Margin="0,0,0,10">
                        <TextBlock Text="Mistral API Key:" FontWeight="Bold" Margin="0,0,0,5"/>
                        <PasswordBox x:Name="MistralApiKeyPasswordBox" Width="300" HorizontalAlignment="Left" KeyDown="MistralApiKeyPasswordBox_PasswordChanged"/>
                        <TextBlock Text="Model:" FontWeight="Bold" Margin="0,10,0,5"/>
                        <ComboBox x:Name="MistralModelComboBox" Width="300" HorizontalAlignment="Left"/>
                        <Button Content="Get API Key" HorizontalAlignment="Left" Margin="0,10,0,0" Padding="8,3" Click="GetApiKey_Click" Tag="https://console.mistral.ai/"/>

                        <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray" Margin="0,5,0,0">
                            Note: Mistral provides efficient translations but requires an API key.
                        </TextBlock>
                    </StackPanel>

                    <!-- Ollama Model -->
                    <StackPanel x:Name="OllamaModelPanel" Visibility="Collapsed" Margin="0,0,0,10">
                        <TextBlock Text="Ollama Model:" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBox x:Name="OllamaModelTextBox" Width="300" HorizontalAlignment="Left" TextChanged="OllamaModelTextBox_TextChanged"/>

                        <Button Content="Download Ollama" HorizontalAlignment="Left" Margin="0,10,0,0" Padding="8,3" Click="GetApiKey_Click" Tag="https://ollama.com/download"/>

                        <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray" Margin="0,5,0,0">
                            Note: Ollama runs locally on your PC and doesn't require internet access, but needs good hardware.
                        </TextBlock>
                    </StackPanel>

                    <!-- LM Studio Model -->
                    <StackPanel x:Name="LMStudioModelPanel" Visibility="Collapsed" Margin="0,0,0,10">
                        <TextBlock Text="LM Studio Model:" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBox x:Name="LMStudioModelTextBox" Width="300" HorizontalAlignment="Left" TextChanged="LMStudioModelTextBox_TextChanged"/>

                        <Button Content="Download LMStudio" HorizontalAlignment="Left" Margin="0,10,0,0" Padding="8,3" Click="GetApiKey_Click" Tag="https://lmstudio.ai/download"/>

                        <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="LightGray" Margin="0,5,0,0">
                            Note: LM Studio runs locally on your PC and doesn't require internet access, but needs good hardware.
                        </TextBlock>
                    </StackPanel>

                    <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,10,0,20">
                        <StackPanel>
                            <TextBlock FontWeight="Bold" FontSize="16" Foreground="#3498db" Margin="0,0,0,10">Translation Service Recommendations:</TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                <Run FontWeight="Bold">Speed:</Run> The translation speed depends on the LLM model, try different models to find the most suitable one.
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="0,5,0,0">
                                <Run FontWeight="Bold">For beginners:</Run> Google Translate (free, no setup required)
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="0,5,0,0">
                                <Run FontWeight="Bold">For best quality:</Run> ChatGPT (requires paid API key)
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="0,5,0,0">
                                <Run FontWeight="Bold">For offline use:</Run> Ollama (requires local installation)
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="0,5,0,0">
                                <Run FontWeight="Bold">For offline use:</Run> LM Studio (requires local installation)
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap" Margin="0,5,0,0">
                                <Run FontWeight="Bold">For balance of quality/cost:</Run> Gemini, Mistral (free tier available)
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Complete Panel -->
                <StackPanel x:Name="CompletePanel" Visibility="Collapsed">
                    <TextBlock TextWrapping="Wrap" FontSize="20" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,20">
                        Setup Complete! 
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" FontWeight="Bold" Margin="0,0,0,20">
                        If you want to review this setup, click the quick setup button on the main screen
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        You've successfully configured the basic settings for RST Game Translation. Your changes will be saved after you click the finish button.
                    </TextBlock>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Margin="0,0,0,20">
                        Here's a summary of your settings:
                    </TextBlock>

                    <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,0,0,20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Languages:" FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="LanguagesSummaryText" Text="Japanese → English" Margin="0,0,0,10"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="OCR Method:" FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="OcrMethodSummaryText" Text="Windows OCR" Margin="0,0,0,10"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Translation Service:" FontWeight="Bold" Foreground="#3498db" Margin="0,0,10,10"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" x:Name="TranslationServiceSummaryText" Text="Google Translate"/>
                        </Grid>
                    </Border>

                    <TextBlock TextWrapping="Wrap" FontSize="16" FontWeight="Bold" Margin="0,0,0,10">
                        Next Steps:
                    </TextBlock>

                    <Border Background="#252525" CornerRadius="5" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                <Run FontWeight="Bold" Foreground="#3498db">1. Select Translation Area</Run>
                                <LineBreak/>
                                Click the "Select Area" button in the main window to choose the area of your screen containing text to translate.
                            </TextBlock>

                            <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                <Run FontWeight="Bold" Foreground="#3498db">2. Start Translation</Run>
                                <LineBreak/>
                                Click the "Start" button to begin the translation process. The translation is in real time.
                            </TextBlock>

                            <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                <Run FontWeight="Bold" Foreground="#3498db">3. View Translation History</Run>
                                <LineBreak/>
                                Click the "Chat Box" button to view your translation history and manage translated text.
                            </TextBlock>

                            <TextBlock TextWrapping="Wrap">
                                <Run FontWeight="Bold" Foreground="#3498db">4. View Translation Overlay (works only on Windows 11)</Run>
                                <LineBreak/>
                                Click the "Overlay" button to display the translation over the original text position on the screen.
                            </TextBlock>
                        </StackPanel>
                    </Border>

                    <Border Background="#1E1E1E" BorderBrush="#3498db" BorderThickness="1" CornerRadius="5" Padding="15">
                        <StackPanel>
                            <TextBlock TextWrapping="Wrap" FontWeight="Bold" Foreground="#3498db" Margin="0,0,0,10">
                                Need Help?
                            </TextBlock>
                            <TextBlock TextWrapping="Wrap">
                                Join our Discord community for support, tips, and to connect with other users.
                            </TextBlock>
                            <Button Content="Join Discord" HorizontalAlignment="Left" Margin="0,10,0,0" Padding="10,5" Click="JoinDiscord_Click"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </ScrollViewer>

        <Rectangle Grid.Row="1" Height="1" Fill="#333333" VerticalAlignment="Bottom"/>

        <!-- Footer with navigation buttons -->
        <Grid Grid.Row="2" Margin="20,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <CheckBox Grid.Column="0" x:Name="DontShowAgainCheckBox" VerticalAlignment="Center"
                Checked="DontShowAgainCheckBox_CheckedChanged"
                Unchecked="DontShowAgainCheckBox_CheckedChanged">
                <TextBlock Text="Don't show this guide again" Foreground="Red"/>
            </CheckBox>

            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="PrevButton" Content="Previous" Width="80" Margin="0,0,10,0" Click="PrevButton_Click"/>
                <Button x:Name="NextButton" Content="Next" Width="80" Click="NextButton_Click"/>
                <Button x:Name="FinishButton" Content="Finish" Width="80" Visibility="Collapsed" Click="FinishButton_Click"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>